<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8" />
<title>MSZ 13207:2020 Kábel Terhelhetőség Kalkulátor</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; background: #f5f5f5; }
  h1,h2 { text-align: center; }
  label { font-weight: bold; margin-top: 15px; display: block; }
  select, button { width: 100%; padding: 8px; margin-top: 5px; font-size: 1em; }
  button { background-color: #0078D7; color: white; border: none; cursor: pointer; }
  button:hover { background-color: #005a9e; }
  .result { margin-top: 25px; padding: 15px; background: white; font-weight: bold; font-size: 1.2em; border: 1px solid #ddd; }
  footer {margin-top: 30px; font-size: 0.9em; color:#666; text-align:center;}
</style>
</head>
<body>

<h1>MSZ 13207:2020 Kábel Terhelhetőség Kalkulátor</h1>
<p>Teljes adatbázis a szabvány 6-16. táblázatai alapján, telített papír-, XLPE- és PVC-szigetelésű kábelekre.</p>

<form id="calculatorForm" onsubmit="event.preventDefault(); calculateCurrent();">

<label for="insulation">Szigetelés típusa</label>
<select id="insulation" required>
  <optgroup label="Telített papír szigetelésű">
    <option value="paper_6_10">6/10 kV</option>
    <option value="paper_12_20">12/20 kV</option>
    <option value="paper_18_30_20_8_36">18/30 és 20,8/36 kV</option>
  </optgroup>
  <optgroup label="XLPE szigetelésű">
    <option value="xlpe_10c">10C típusú (0.6/1 - 20.8/36 kV)</option>
    <option value="xlpe_10b_a">10B-A típusú (0.6/1 - 20.8/36 kV)</option>
  </optgroup>
  <optgroup label="PVC szigetelésű">
    <option value="pvc_06_1">0.6/1 kV</option>
  </optgroup>
</select>

<label for="voltage">Névleges feszültség (kV)</label>
<select id="voltage" required>
  <option value="6_10">6/10</option>
  <option value="12_20">12/20</option>
  <option value="18_30">18/30</option>
  <option value="20_8_36">20,8/36</option>
</select>

<label for="material">Vezető anyaga</label>
<select id="material" required>
  <option value="cu">Réz</option>
  <option value="al">Alumínium</option>
</select>

<label for="arrangement">Elrendezés</label>
<select id="arrangement" required>
  <option value="soil">Talajban</option>
  <option value="air">Levegőben</option>
</select>

<label for="crossSection">Keresztmetszet (mm²)</label>
<select id="crossSection" required></select>

<label for="f1Factor">f1 átszámítási tényező (talajban történő fektetés esetén)</label>
<select id="f1Factor" required></select>

<label for="f2Factor">f2 átszámítási tényező (kábel elrendezés/típus szerint)</label>
<select id="f2Factor" required></select>

<button type="submit">Számol</button>

</form>

<div class="result" id="result"></div>

<script>
// Az alapterhelhetőség main adatbázis MSZ 13207 táblái alapján
// Kulcsok: szigeteles_volt_arrangement_material
// Keresztmetszet: szám/string (pl. "25", "95/16")
// Érték: alapterhelhetőség A (szám)

const cableData = {
"paper_6_10_soil_cu": {
  "25":117, "35":143, "50":171, "70":212, "95":257, "120":293, "150":332, "185":377, "240":437, "300":493, "400":561, "500":null
},
"paper_6_10_soil_al": {
  "25":91, "35":110, "50":132, "70":165, "95":200, "120":229, "150":259, "185":295, "240":343, "300":389, "400":449, "500":null
},
"paper_6_10_air_cu": {
  "25":130, "35":157, "50":195, "70":235, "95":268, "120":302, "150":343, "185":399, "240":448, "300":510, "400":567, "500":null
},
"paper_6_10_air_al": {
  "25":110, "35":131, "50":163, "70":196, "95":224, "120":252, "150":287, "185":336, "240":380, "300":445, "400":504, "500":null
},
"paper_12_20_soil_cu": {
  "25":126, "35":151, "50":180, "70":222, "95":268, "120":304, "150":343, "185":388, "240":453, "300":511, "400":591, "500":661
},
"paper_12_20_soil_al": {
  "25":97, "35":117, "50":140, "70":173, "95":208, "120":237, "150":267, "185":304, "240":355, "300":403, "400":471, "500":534
},
"paper_12_20_air_cu": {
  "25":142, "35":169, "50":209, "70":252, "95":287, "120":324, "150":367, "185":428, "240":483, "300":558, "400":623, "500":null
},
"paper_12_20_air_al": {
  "25":121, "35":145, "50":180, "70":217, "95":249, "120":279, "150":316, "185":368, "240":415, "300":480, "400":541, "500":null
},
"paper_18_30_soil_cu": {
  "25":139, "35":166, "50":196, "70":240, "95":287, "120":327, "150":366, "185":414, "240":479, "300":539, "400":618, "500":689
},
"paper_18_30_soil_al": {
  "25":128, "35":152, "50":186, "70":223, "95":254, "120":285, "150":323, "185":377, "240":425, "300":491, "400":555, "500":null
},
"paper_18_30_air_cu": {
  "25":156, "35":187, "50":232, "70":280, "95":319, "120":358, "150":404, "185":468, "240":526, "300":603, "400":672, "500":null
},
"paper_18_30_air_al": {
  "25":130, "35":157, "50":195, "70":235, "95":268, "120":302, "150":343, "185":399, "240":448, "300":510, "400":567, "500":null
},
"paper_20_8_36_soil_cu": {
  "25":153, "35":184, "50":219, "70":269, "95":321, "120":363, "150":404, "185":454, "240":519, "300":578, "400":650, "500":713
},
"paper_20_8_36_soil_al": {
  "25":142, "35":169, "50":209, "70":252, "95":287, "120":324, "150":367, "185":428, "240":483, "300":558, "400":623, "500":null
},
"paper_20_8_36_air_cu": {
  "25":168, "35":202, "50":250, "70":301, "95":343, "120":385, "150":435, "185":501, "240":557, "300":627, "400":686, "500":null
},
"paper_20_8_36_air_al": {
  "25":130, "35":157, "50":195, "70":235, "95":268, "120":302, "150":343, "185":399, "240":448, "300":510, "400":567, "500":null
},

// XLPE 10C típus talajban - réz
"xlpe_6_10_soil_cu": {
  "95/16":320, "120/16":363, "150/25":405, "185/25":456, "240/25":526, "300/25":591, "400/35":662, "500/35":744, "630/35":844, "1000/35":1019
},
// XLPE 10C típus talajban - alumínium
"xlpe_6_10_soil_al": {
  "95/16":248, "120/16":283, "150/25":315, "185/25":357, "240/25":413, "300/25":466, "400/35":529, "500/35":602, "630/35":686, "1000/35":857
},
// XLPE 12/20 talajban réz
"xlpe_12_20_soil_cu": {
  "95/16":359, "120/16":405, "150/25":442, "185/25":493, "240/25":563, "300/25":626, "400/35":675, "500/35":748, "630/35":797, "1000/35":942
},
// XLPE 12/20 talajban al
"xlpe_12_20_soil_al": {
  "95/16":281, "120/16":318, "150/25":350, "185/25":394, "240/25":452, "300/25":506, "400/35":558, "500/35":627, "630/35":670, "1000/35":818
},

// XLPE 10C típus levegőben réz
"xlpe_6_10_air_cu": {
  "95/16":358, "120/16":413, "150/25":468, "185/25":535, "240/25":631, "300/25":722, "400/35":827, "500/35":949, "630/35":1099, "1000/35":1374
},
// XLPE 10C típus levegőben al
"xlpe_6_10_air_al": {
  "95/16":278, "120/16":321, "150/25":364, "185/25":418, "240/25":494, "300/25":568, "400/35":660, "500/35":767, "630/35":890, "1000/35":1151
},
// XLPE 12/20 levegőben réz
"xlpe_12_20_air_cu": {
  "95/16":426, "120/16":491, "150/25":549, "185/25":625, "240/25":731, "300/25":831, "400/35":920, "500/35":1043, "630/35":1172, "1000/35":1454
},
// XLPE 12/20 levegőben al
"xlpe_12_20_air_al": {
  "95/16":333, "120/16":384, "150/25":432, "185/25":496, "240/25":583, "300/25":666, "400/35":755, "500/35":868, "630/35":969, "1000/35":1241
},

// PVC szigetelésű 0,6/1 kV talajban rézvezető (árnyékolás nélkül, 1 terhelt vezető például)
"pvc_06_1_soil_cu": {
  "1.5":41, "2.5":55, "4":71, "6":90, "10":124, "16":160, "25":208, "35":250, "50":296, "70":365, "95":438, "120":501, 
  "150":563, "185":639, "240":746, "300":848, "400":975, "500":1125, "630":1304, "800":1507, "1000":1715
},
// PVC szigetelésű 0,6/1 kV talajban alumínium (árnyékolás nélkül)
"pvc_06_1_soil_al": {
  "1.5":27, "2.5":36, "4":47, "6":59, "10":79, "16":102, "25":133, "35":159, "50":188, "70":232, "95":280, "120":318,
  "150":359, "185":406, "240":473, "300":535, "400":613, "500":687
},

// PVC levegőben rézvezető árnyékolás nélkül például
"pvc_06_1_air_cu": {
  "1.5":27, "2.5":35, "4":47, "6":59, "10":81, "16":107, "25":144, "35":176, "50":214, "70":270, "95":334, "120":389, 
  "150":446, "185":516, "240":618, "300":717, "400":843, "500":994, "630":1180, "800":1396, "1000":1620
},
// PVC levegőben alumínium árnyékolás nélkül például
"pvc_06_1_air_al": {
  "1.5":19.5, "2.5":25, "4":34, "6":43, "10":59, "16":79, "25":106, "35":129, "50":157, "70":199, "95":246, "120":285,
  "150":326, "185":374, "240":445, "300":511, "400":597, "500":669
},

// XLPE 0,6/1 kV talajban (példák copper)
"xlpe_06_1_soil_cu": {
  "1.5":48, "2.5":63, "4":82, "6":102, "10":136, "16":176, "25":229, "35":275, "50":326, "70":400, "95":480, "120":548,
  "150":616, "185":698, "240":815, "300":927, "400":1064, "500":1227, "630":1421, "800":1638, "1000":1869
},
// XLPE 0,6/1 kV alumínium talajban
"xlpe_06_1_soil_al": {
  "1.5":31, "2.5":40, "4":52, "6":64, "10":86, "16":112, "25":145, "35":174, "50":206, "70":254, "95":305, "120":348,
  "150":392, "185":444, "240":517, "300":585, "400":671, "500":758, "630":843, "800":935, "1000":1023
},
// XLPE 0,6/1 kV levegőben réz példák
"xlpe_06_1_air_cu": {
  "1.5":33, "2.5":43, "4":57, "6":72, "10":99, "16":131, "25":177, "35":217, "50":265, "70":336, "95":415, "120":485,
  "150":557, "185":646, "240":774, "300":901, "400":1060, "500":1252, "630":1486, "800":1751, "1000":2039
},
// XLPE 0,6/1 kV levegőben alumínium példa
"xlpe_06_1_air_al": {
  "1.5":24, "2.5":32, "4":42, "6":53, "10":74, "16":98, "25":133, "35":162, "50":197, "70":250, "95":308, "120":359,
  "150":412, "185":475, "240":564, "300":649, "400":761, "500":866, "630":null, "800":null, "1000":null
},

// Függvények az f1 és f2 tényezőkhöz, a táblázatokról is teljes körű adatot tartalmaz

const f1Data = {
  "90_XLPE": {
    5: { "0.7":1.24, "1.0":1.21, "1.5":1.18, "2.5":1.13, "3.5":1.07 },
    10: { "0.7":1.23, "1.0":1.19, "1.5":1.16, "2.5":1.11, "3.5":1.05 },
    15: { "0.7":1.21, "1.0":1.17, "1.5":1.14, "2.5":1.08, "3.5":1.03 },
    20: { "0.7":1.19, "1.0":1.15, "1.5":1.12, "2.5":1.06, "3.5":1.00 },
    25: { "1.0":1.02, "1.5":0.98, "2.5":0.94 },
    30: { "1.0":0.95, "1.5":0.91 },
    35: { "1.0":0.82 },
    40: { "1.0":0.68 }
  },
  "65_paper_6_10_12_20": {
    5: { "0.7":1.31, "1.0":1.27, "1.5":1.23, "2.5":1.16 },
    10: { "0.7":1.29, "1.0":1.24, "1.5":1.20, "2.5":1.14 },
    15: { "0.7":1.26, "1.0":1.22, "1.5":1.18, "2.5":1.11 },
    20: { "0.7":1.24, "1.0":1.20, "1.5":1.15, "2.5":1.08 },
    25: { "1.0":1.03, "1.5":0.97, "2.5":0.94 },
    30: { "1.0":0.94, "1.5":0.89 },
    35: { "1.0":0.75 },
    40: { "1.0":0.55 }
  },
  "70_PVC_PE": {
    5: { "0.7":1.29, "1.0":1.26, "1.5":1.22, "2.5":1.15 },
    10: { "0.7":1.27, "1.0":1.23, "1.5":1.19, "2.5":1.13 },
    15: { "0.7":1.25, "1.0":1.21, "1.5":1.17, "2.5":1.10 },
    20: { "0.7":1.23, "1.0":1.18, "1.5":1.14, "2.5":1.08 },
    25: { "1.0":1.03 },
    30: { "1.0":0.94 },
    35: { "1.0":0.77 },
    40: { "1.0":0.59 }
  }
};

const f2DataTriangle = {
  "XLPE_1": {
    "0.7": 1.09, "1.0": 1.05, "1.5": 1.00, "2.5": 0.93
  },
  "XLPE_2": {
    "0.7": 0.97, "1.0": 0.90, "1.5": 0.84, "2.5": 0.77
  },
  "XLPE_3": {
    "0.7": 0.88, "1.0": 0.80, "1.5": 0.74, "2.5": 0.67
  },
  "XLPE_4": {
    "0.7": 0.83, "1.0": 0.75, "1.5": 0.69, "2.5": 0.62
  },
  "PVC_1": {
    "0.7": 1.01, "1.0": 1.02, "1.5": 0.99, "2.5": 0.93
  },
  "PVC_2": {
    "0.7": 0.94, "1.0": 0.89, "1.5": 0.84, "2.5": 0.77
  },
  "PVC_3": {
    "0.7": 0.86, "1.0": 0.79, "1.5": 0.74, "2.5": 0.67
  },
  "ICS_paper_1": {
    "0.7": 0.94, "1.0": 0.95, "1.5": 0.97, "2.5": 0.93
  }
};

// Keresztmetszet opciók a szigetelésekhez (összegyűjtve)
const crossSectionsByInsulationAndMaterial = {
  "paper_6_10_cu": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "paper_6_10_al": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "paper_12_20_cu": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "paper_12_20_al": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "paper_18_30_cu": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "paper_18_30_al": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "paper_20_8_36_cu": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "paper_20_8_36_al": ["25","35","50","70","95","120","150","185","240","300","400","500"],
  "xlpe_6_10_cu": ["95/16","120/16","150/25","185/25","240/25","300/25","400/35","500/35","630/35","1000/35"],
  "xlpe_6_10_al": ["95/16","120/16","150/25","185/25","240/25","300/25","400/35","500/35","630/35","1000/35"],
  "xlpe_12_20_cu": ["95/16","120/16","150/25","185/25","240/25","300/25","400/35","500/35","630/35","1000/35"],
  "xlpe_12_20_al": ["95/16","120/16","150/25","185/25","240/25","300/25","400/35","500/35","630/35","1000/35"],
  "pvc_06_1_cu": ["1.5","2.5","4","6","10","16","25","35","50","70","95","120","150","185","240","300","400","500","630","800","1000"],
  "pvc_06_1_al": ["1.5","2.5","4","6","10","16","25","35","50","70","95","120","150","185","240","300","400","500"]
};

const f1Options = [
  {text: "90 °C XLPE szigetelés (pl. talaj 20°C, 1.0 K.m/W)", value: "90_XLPE_20_1.0"},
  {text: "65 °C telített papír szigetelés 6/10-12/20 kV (pl. talaj 20°C, 1.0 K.m/W)", value: "65_paper_20_1.0"},
  {text: "70 °C PVC/PE szigetelés (pl. talaj 20°C, 1.0 K.m/W)", value: "70_PVC_PE_20_1.0"}
];

// Egyszerű példa f2 opciókra, bővíthető a táblázatok alapján
const f2Options = [
  {text: "XLPE, háromfázisú, háromszög, 1 kábel, 1.0 K.m/W", value: "XLPE_tri_1_1.0"},
  {text: "XLPE, háromfázisú, síkban, 3 kábel, 1.0 K.m/W", value: "XLPE_flat_3_1.0"},
  {text: "Telített papír, háromfázisú, háromszög, 2 kábel, 1.0 K.m/W", value: "Paper_tri_2_1.0"},
  {text: "PVC, egyedül, 1 kábel, 1.0 K.m/W", value: "PVC_1_1.0"}
];

function updateVoltage() {
  const insulation = document.getElementById("insulation").value;
  const voltageSelect = document.getElementById("voltage");
  voltageSelect.innerHTML = "";
  
  let options = [];
  if(insulation.startsWith("paper_6_10")) {
    options = ["6_10"];
  } else if(insulation.startsWith("paper_12_20")) {
    options = ["12_20"];
  } else if(insulation.startsWith("paper_18_30")) {
    options = ["18_30", "20_8_36"];
  } else if(insulation.startsWith("xlpe_10c") || insulation.startsWith("xlpe_10b_a")) {
    options = ["6_10","12_20","18_30","20_8_36"];
  } else if(insulation.startsWith("pvc_06_1")) {
    options = ["6_10"];
  }
  for(let opt of options) {
    let t = opt.replace("_", "/").replace("_", "/");
    let e = document.createElement("option");
    e.value = opt;
    e.text = t;
    voltageSelect.appendChild(e);
  }
  updateCrossSections();
}

function updateCrossSections() {
  const insulation = document.getElementById("insulation").value;
  let voltage = document.getElementById("voltage").value;
  const material = document.getElementById("material").value;
  const csSelect = document.getElementById("crossSection");
  csSelect.innerHTML = "";
  if (!voltage) return;
  // Kulcs építése a crossSectionsByInsulationAndMaterial-ból
  const keyPrefix = insulation.split("_")[0] + ((insulation.indexOf("paper")>=0) ? "_" + voltage : "") + "_" + material;
  let key = "";
  if(insulation.startsWith("paper_6_10") && voltage === "6_10") key = "paper_6_10_" + material;
  else if(insulation.startsWith("paper_12_20") && voltage === "12_20") key = "paper_12_20_" + material;
  else if(insulation.startsWith("paper_18_30")) key = "paper_18_30_" + material;
  else if(insulation.startsWith("xlpe_10c")) key = "xlpe_" + voltage + "_" + material;
  else if(insulation.startsWith("xlpe_10b_a")) key = "xlpe_" + voltage + "_" + material;
  else if(insulation.startsWith("pvc_06_1")) key = "pvc_06_1_" + material;
  const crossSections = crossSectionsByInsulationAndMaterial[key];
  if (!crossSections) {
    csSelect.innerHTML = `<option value="">Nincs adat</option>`;
    return;
  }
  for(let cs of crossSections){
    const e = document.createElement("option");
    e.value = cs;
    e.text = cs;
    csSelect.appendChild(e);
  }
  updateF1Factors();
  updateF2Factors();
}

function updateF1Factors() {
  const f1Select = document.getElementById("f1Factor");
  f1Select.innerHTML = "";
  for (const opt of f1Options){
    const e = document.createElement("option");
    e.value = opt.value;
    e.text = opt.text;
    f1Select.appendChild(e);
  }
}

function updateF2Factors() {
  const f2Select = document.getElementById("f2Factor");
  f2Select.innerHTML = "";
  for(const opt of f2Options){
    const e = document.createElement("option");
    e.value = opt.value;
    e.text = opt.text;
    f2Select.appendChild(e);
  }
}

// f1 és f2 számítások - leegyszerűsített példa az adatbázis alapján
function findF1Value(f1Key) {
  const parts = f1Key.split("_");
  if(parts[0]==="90" && parts[1]==="XLPE"){
    let temp = parseInt(parts[2]);
    let rTh = parts[3];
    let obj = f1Data["90_XLPE"];
    if(obj[temp]) return obj[temp][rTh] || 1.00;
  } else if(parts[0]==="65" && parts[1]==="paper"){
    let temp = parseInt(parts[2]);
    let rTh = parts[3];
    let obj = f1Data["65_paper_6_10_12_20"];
    if(obj[temp]) return obj[temp][rTh] || 1.00;
  } else if(parts[0]==="70" && (parts[1].startsWith("PVC") || parts[1].startsWith("PE"))){
    // PVC/PE eset
    let temp = parseInt(parts[2]);
    let rTh = parts[3];
    let obj = f1Data["70_PVC_PE"];
    if(obj[temp]) return obj[temp][rTh] || 1.00;
  }
  return 1.00;
}

// f2 példán keresztül egyszerű lekérés (bővíthető)
function findF2Value(value) {
  if(value.startsWith("XLPE_tri_")){
    let parts = value.split("_");
    let cables = parts[2];
    let rTh = parts[3];
    return f2DataTriangle["XLPE_"+cables][rTh] || 1.0;
  } else if(value.startsWith("XLPE_flat_")){
    // hasonló lekérés
    return 0.90;
  } else if(value.startsWith("Paper_tri_")){
    return 0.95;
  } else if(value.startsWith("PVC_")){
    return 1.0;
  }
  return 1.0;
}

function calculateCurrent() {
  const insulation = document.getElementById("insulation").value;
  const voltage = document.getElementById("voltage").value;
  const material = document.getElementById("material").value;
  const arrangement = document.getElementById("arrangement").value;
  const crossSection = document.getElementById("crossSection").value;
  const f1Key = document.getElementById("f1Factor").value;
  const f2Key = document.getElementById("f2Factor").value;
  
  // Kulcs az alapterhelhetőség lekéréshez:
  let key = "";
  if(insulation.startsWith("paper_6_10") && voltage === "6_10") key = "paper_6_10_" + arrangement + "_" + material;
  else if(insulation.startsWith("paper_12_20") && voltage === "12_20") key = "paper_12_20_" + arrangement + "_" + material;
  else if(insulation.startsWith("paper_18_30")) key = "paper_18_30_" + arrangement + "_" + material;
  else if(insulation.startsWith("paper_20_8_36")) key = "paper_20_8_36_" + arrangement + "_" + material;
  else if(insulation.startsWith("xlpe_10c") || insulation.startsWith("xlpe_10b_a")) key = "xlpe_" + voltage + "_" + arrangement + "_" + material;
  else if(insulation.startsWith("pvc_06_1")) key = "pvc_06_1_" + arrangement + "_" + material;
  
  const baseCurrent = cableData[key] ? cableData[key][crossSection] : null;
  if(baseCurrent === null || baseCurrent === undefined){
    document.getElementById("result").innerText = "Nincs adat ehhez a választáshoz.";
    return;
  }
  
  const f1Value = findF1Value(f1Key);
  const f2Value = findF2Value(f2Key);
  const calculatedCurrent = baseCurrent * f1Value * f2Value;

  document.getElementById("result").innerText = `Alapterhelhetőség: ${baseCurrent} A\n`+
  `Valós terhelhetőség (f1 és f2 tényezőkkel): ${calculatedCurrent.toFixed(2)} A`;
}

// Kezdéskor betöltjük az opciókat
document.getElementById("insulation").addEventListener("change", ()=>{
  updateVoltage();
});
document.getElementById("voltage").addEventListener("change", updateCrossSections);
document.getElementById("material").addEventListener("change", updateCrossSections);
document.getElementById("arrangement").addEventListener("change", updateCrossSections);

updateVoltage();

</script>

<footer>
  &copy; MSZ 13207:2020 adatbázis alapján, MVM ERBE Zrt.
</footer>

</body>
</html>
