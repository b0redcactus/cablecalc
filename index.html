<!doctype html>
<html lang="hu">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kábel terhelhetőség</title>
<style>
  :root{
    --bg: #16161a;
    --surface: #1c1c21;
    --surface-hover: #202026;
    --border: #2a2a30;
    --text: #e4e4e7;
    --text-secondary: #a1a1aa;
    --accent: #8b5cf6;
    --accent-hover: #7c3aed;
    --success: #10b981;
    --warning: #f59e0b;
    --error: #ef4444;
  }
  
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  body {
    background: var(--bg);
    color: var(--text);
    font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', sans-serif;
    font-size: 14px;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
  }
  
  .wrap {
    max-width: 1280px;
    margin: 0 auto;
    padding: 48px 24px;
  }
  
  h1 {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 6px;
    color: var(--text);
    letter-spacing: -0.3px;
  }
  
  .sub {
    color: var(--text-secondary);
    font-size: 14px;
    margin-bottom: 32px;
  }
  
  .sub strong {
    color: var(--text);
    font-weight: 500;
  }
  
  .grid {
    display: grid;
    gap: 16px;
  }
  
  @media(min-width: 980px) {
    .grid {
      grid-template-columns: 1.4fr 1fr;
    }
  }
  
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 24px;
    transition: border-color 0.15s ease;
  }
  
  .card:hover {
    border-color: #333339;
  }
  
  .row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 12px;
  }
  
  label {
    display: block;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    margin-bottom: 8px;
  }
  
  input, select {
    width: 100%;
    padding: 8px 12px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text);
    font-size: 14px;
    font-family: inherit;
    transition: all 0.15s ease;
  }
  
  input:focus, select:focus {
    outline: none;
    border-color: var(--accent);
    background: var(--surface);
  }
  
  input:hover, select:hover {
    border-color: #333339;
  }
  
  input::placeholder {
    color: #52525b;
  }
  
  .pill {
    display: inline-block;
    font-size: 12px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 16px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    opacity: 0.9;
  }
  
  .muted {
    color: var(--text-secondary);
    font-size: 13px;
  }
  
  .mono {
    font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;
    font-size: 15px;
    color: var(--text);
    margin-top: 4px;
  }
  
  .big {
    font-size: 42px;
    font-weight: 600;
    letter-spacing: -1.5px;
    color: var(--accent);
    margin-top: 4px;
  }
  
  .btn {
    padding: 8px 16px;
    background: var(--surface-hover);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text);
    font-size: 13px;
    font-weight: 500;
    font-family: inherit;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  
  .btn:hover {
    background: #25252b;
    border-color: #333339;
  }
  
  .btn:active {
    transform: scale(0.98);
  }
  
  hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 20px 0;
  }
  
  details {
    margin-top: 16px;
    padding: 12px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 6px;
  }
  
  summary {
    color: var(--text-secondary);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    user-select: none;
    list-style: none;
  }
  
  summary::-webkit-details-marker {
    display: none;
  }
  
  summary:hover {
    color: var(--text);
  }
  
  details[open] summary {
    margin-bottom: 12px;
  }
  
  details p {
    margin: 8px 0;
    line-height: 1.6;
  }
  
  code {
    background: var(--bg);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'SF Mono', 'Consolas', monospace;
    font-size: 12px;
  }
  
  .note {
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: 16px;
    padding: 12px;
    background: var(--bg);
    border-radius: 6px;
    border-left: 2px solid var(--border);
    line-height: 1.5;
  }
  
  .ok {
    color: var(--success);
  }
  
  .bad {
    color: var(--error);
  }
  
  .result-grid {
    display: grid;
    gap: 12px;
    margin-top: 16px;
  }
  
  .result-item {
    padding: 16px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    transition: border-color 0.15s ease;
  }
  
  .result-item:hover {
    border-color: #333339;
  }
  
  #system-card {
    background: var(--surface);
  }
  
  .btn-group {
    display: flex;
    justify-content: flex-start;
    gap: 8px;
    margin-top: 20px;
  }
  
  @media(max-width: 979px) {
    .wrap {
      padding: 32px 16px;
    }
    h1 {
      font-size: 22px;
    }
    .big {
      font-size: 36px;
    }
  }
</style>
</head>
<body>
<div class="wrap">
  <h1>Földkábel terhelhetőség/Cable current capacity</h1>
  <div class="sub">A = <strong>Alapterhelhetőség/Base load</strong> × <strong>f1</strong> × <strong>f2</strong></div>
  
  <div class="grid">
    <section class="card">
      <div class="pill">1. Alap</div>
      <label for="base">Alapterhelhetőség/Base load (A)</label>
      <input id="base" type="number" min="0" step="0.1" placeholder="pl. 250" />
      
      <hr />
      
      <div class="pill">2. f1</div>
      <div class="row">
        <div>
          <label for="f1type">Kábel típusa/Cable type</label>
          <select id="f1type" title="Kábel típusa felhasználása az f1 táblázatban">
            <option value="XLPE90">90 °C – XLPE-szigetelésű</option>
            <option value="PVC70">70 °C – PVC-szigetelésű</option>
            <option value="PE70">70 °C – PE-szigetelésű</option>
            <option value="PAPER65">65 °C – Telített papírszigetelésű (6/10–12/20 kV)</option>
            <option value="PAPER60">60 °C – Telített papírszigetelésű (18/30–20,8/36 kV)</option>
          </select>
        </div>
        <div>
          <label for="soilT">Talaj hőmérséklete/Soil temp (°C)</label>
          <select id="soilT" title="Talaj hőmérséklete">
            <option>5</option><option>10</option><option>15</option><option>20</option><option>25</option>
          </select>
        </div>
      </div>
      
      <div class="row">
        <div>
          <label for="rho">Talaj fajlagos hőellenállása/Soil thermal resistivity</label>
          <select id="rho" title="Talaj fajlagos hőellenállása">
            <option>0.7</option><option>1.0</option><option>1.5</option><option>2.5</option>
          </select>
        </div>
        <div>
          <label for="lf">Terhelési tényező/Load factor</label>
          <select id="lf" title="Terhelési tényező">
            <option>0.50</option><option>0.60</option><option>0.70</option><option>0.85</option><option>1.00</option>
          </select>
        </div>
      </div>
      
      <hr />
      
      <div class="pill">3. f2</div>
      <div class="row">
        <div>
          <label for="arr">Kábel elrendezés/Cable arrangement</label>
          <select id="arr" title="Kábel elrendezés az f2 táblázatok szerint">
            <option value="triangle7">Háromszögben, 7 cm</option>
            <option value="triangle25">Háromszögben, 25 cm</option>
            <option value="flat7">Síkban, 7 cm</option>
            <option value="3core">Háromerű kábel, síkban, 7 cm</option>
          </select>
        </div>
        <div>
          <label for="f2type">Kábel típusa/Cable type</label>
          <select id="f2type" title="Kábel típusa az f2 táblázatok szerint">
            <option value="XLPE">XLPE-szigetelésű</option>
            <option value="PE">PE-szigetelésű</option>
            <option value="PVC">PVC-szigetelésű</option>
            <option value="Paper">Telített papírszigetelésű</option>
          </select>
        </div>
      </div>
      
      <div class="row">
        <div>
          <label for="systems">Kábelrendszerek száma/Cable systems</label>
          <select id="systems" title="Kábelrendszerek száma">
            <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>8</option><option>10</option>
          </select>
        </div>
        <div>
          <label for="rho2">Talaj fajlagos hőellenállása/Soil thermal resistivity</label>
          <select id="rho2" title="Talaj fajlagos hőellenállása az f2 számításhoz">
            <option>0.7</option><option>1.0</option><option>1.5</option><option>2.5</option>
          </select>
        </div>
      </div>
      
      <div class="row">
        <div>
          <label for="lf2">Terhelési tényező/Load factor</label>
          <select id="lf2" title="Terhelési tényező az f2 számításhoz">
            <option>0.50</option><option>0.60</option><option>0.70</option><option>0.85</option><option>1.00</option>
          </select>
        </div>
      </div>
      
      <hr />
      
      <div class="pill">4. Védőcső</div>
      <div class="row">
        <div>
          <label for="duct">Védőcső/Protective conduit</label>
          <select id="duct" title="Ha van védőcső: 0,85-ös szorzó">
            <option value="no">Nem</option>
            <option value="yes">Igen (0,85×)</option>
          </select>
        </div>
      </div>
      
      <div class="btn-group">
        <button class="btn" id="calc">Számítás</button>
        <button class="btn" id="exportXlsx">XLSX export</button>
      </div>
      
      <div class="note">Megjegyzés: f1-hez a 12.a / 12.b táblák, f2-höz a 13.a–16.b táblázatok adatait használjuk.</div>
    </section>
    
    <section class="card">
      <div class="pill">Eredmény</div>
      <div class="result-grid">
        <div class="result-item">
          <span class="muted">f1 érték</span>
          <div class="mono" id="f1v">–</div>
        </div>
        <div class="result-item">
          <span class="muted">f2 érték</span>
          <div class="mono" id="f2v">–</div>
        </div>
        <div class="result-item">
          <span class="muted">Végső terhelhetőség (A)</span>
          <div class="big" id="total">—</div>
        </div>
      </div>
      
      <hr />
      
      <details>
        <summary>Források</summary>
        <p class="muted">f1 adatok: 12.a (XLPE 90 °C), 12.b (PVC, PE 70 °C; Telített papír 65 °C & 60 °C).</p>
        <p class="muted">f2 adatok: 13.a–13.b (háromszög, 7 cm), 14.a–14.b (háromszög, 25 cm), 15.a–15.b (sík, 7 cm), 16.a–16.b (háromerű, sík, 7 cm).</p>
      </details>
    </section>
    
    <section class="card" id="system-card">
      <div class="pill">5. Rendszer adatai (opcionális)</div>
      
      <div class="row">
        <div>
          <label for="sysU">Névleges feszültség/Nominal voltage</label>
          <select id="sysU" title="Háromfázisú rendszer feszültsége (V)">
            <option value="">– válassz –</option>
            <option value="22000">22 kV</option>
            <option value="11000">11 kV</option>
            <option value="400">0,4 kV</option>
          </select>
        </div>
        <div>
          <label for="sysP">Teljesítmény/Power (kW)</label>
          <input id="sysP" type="number" min="0" step="0.1" placeholder="pl. 500" />
        </div>
      </div>
      
      <div class="muted" style="margin-top: 12px">Háromfázisú képlet: <span class="mono">I = P / (√3 · U)</span></div>
      
      <div class="row" style="margin-top: 16px">
        <div class="result-item">
          <span class="muted">Áram/Current</span>
          <div class="mono" id="sysI">–</div>
        </div>
        <div class="result-item">
          <span class="muted">Megfelelés/Rating check</span>
          <div class="mono" id="sysCheck">–</div>
        </div>
      </div>
    </section>
  </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>


<script>
// 12.a és 12.b teljes f1 adat
//f1:
const f1Data = {
  XLPE90: {
  5:  { "0.7": { "0.50": 1.24, "0.60": 1.21, "0.70": 1.18, "0.85": 1.13, "1.00": 1.07 },
         "1.0": { "0.50": 1.11, "0.60": 1.09, "0.70": 1.07, "0.85": 1.03, "1.00": 1.00 },
         "1.5": { "0.50": 0.99, "0.60": 0.98, "0.70": 0.97, "0.85": 0.96, "1.00": 0.94 },
         "2.5": { "any": 0.89 }},
  10: { "0.7": { "0.50": 1.23, "0.60": 1.19, "0.70": 1.16, "0.85": 1.11, "1.00": 1.05 },
         "1.0": { "0.50": 1.09, "0.60": 1.07, "0.70": 1.05, "0.85": 1.01, "1.00": 0.98 },
         "1.5": { "0.50": 0.97, "0.60": 0.96, "0.70": 0.95, "0.85": 0.93, "1.00": 0.91 },
         "2.5": { "any": 0.86 }},
  15: { "0.7": { "0.50": 1.21, "0.60": 1.17, "0.70": 1.14, "0.85": 1.08, "1.00": 1.03 },
         "1.0": { "0.50": 1.07, "0.60": 1.05, "0.70": 1.02, "0.85": 0.99, "1.00": 0.95 },
         "1.5": { "0.50": 0.95, "0.60": 0.93, "0.70": 0.92, "0.85": 0.91, "1.00": 0.89 },
         "2.5": { "any": 0.84 }},
  20: { "0.7": { "0.50": 1.19, "0.60": 1.15, "0.70": 1.12, "0.85": 1.06, "1.00": 1.00 },
         "1.0": { "0.50": 1.05, "0.60": 1.02, "0.70": 1.00, "0.85": 0.96, "1.00": 0.93 },
         "1.5": { "0.50": 0.92, "0.60": 0.91, "0.70": 0.90, "0.85": 0.88, "1.00": 0.86 },
         "2.5": { "any": 0.81 }},
  25: { "1.0": { "0.50": 1.02, "0.60": 1.00, "0.70": 0.98, "0.85": 0.94, "1.00": 0.90 },
         "1.5": { "0.50": 0.90, "0.60": 0.88, "0.70": 0.87, "0.85": 0.85, "1.00": 0.84 },
         "2.5": { "any": 0.78 }},

},
  
  PVC70: {
  5:  { "0.7": { "0.50": 1.29, "0.60": 1.26, "0.70": 1.22, "0.85": 1.15, "1.00": 1.09 },
         "1.0": { "0.50": 1.13, "0.60": 1.11, "0.70": 1.08, "0.85": 1.04, "1.00": 1.00 },
         "1.5": { "0.50": 0.99, "0.60": 0.98, "0.70": 0.97, "0.85": 0.95, "1.00": 0.93 },
         "2.5": { "any": 0.86 }},
  10: { "0.7": { "0.50": 1.27, "0.60": 1.23, "0.70": 1.19, "0.85": 1.13, "1.00": 1.06 },
         "1.0": { "0.50": 1.11, "0.60": 1.08, "0.70": 1.06, "0.85": 1.01, "1.00": 0.97 },
         "1.5": { "0.50": 0.96, "0.60": 0.95, "0.70": 0.94, "0.85": 0.92, "1.00": 0.89 },
         "2.5": { "any": 0.83 }},
  15: { "0.7": { "0.50": 1.25, "0.60": 1.21, "0.70": 1.17, "0.85": 1.10, "1.00": 1.03 },
         "1.0": { "0.50": 1.08, "0.60": 1.06, "0.70": 1.03, "0.85": 0.99, "1.00": 0.94 },
         "1.5": { "0.50": 0.93, "0.60": 0.92, "0.70": 0.91, "0.85": 0.88, "1.00": 0.86 },
         "2.5": { "any": 0.79 }},
  20: { "0.7": { "0.50": 1.23, "0.60": 1.18, "0.70": 1.14, "0.85": 1.08, "1.00": 1.01 },
         "1.0": { "0.50": 1.06, "0.60": 1.03, "0.70": 1.00, "0.85": 0.96, "1.00": 0.91 },
         "1.5": { "0.50": 0.90, "0.60": 0.89, "0.70": 0.87, "0.85": 0.85, "1.00": 0.83 },
         "2.5": { "any": 0.76 }},
  25: { "1.0": { "0.50": 1.03, "0.60": 1.00, "0.70": 0.97, "0.85": 0.93, "1.00": 0.88 },
         "1.5": { "0.50": 0.87, "0.60": 0.86, "0.70": 0.84, "0.85": 0.83, "1.00": 0.80 },
         "2.5": { "any": 0.72 }},
    
},
  
  PE70: {
5:  { "0.7": { "0.50": 1.29, "0.60": 1.26, "0.70": 1.22, "0.85": 1.15, "1.00": 1.09 },
         "1.0": { "0.50": 1.13, "0.60": 1.11, "0.70": 1.08, "0.85": 1.04, "1.00": 1.00 },
         "1.5": { "0.50": 0.99, "0.60": 0.98, "0.70": 0.97, "0.85": 0.95, "1.00": 0.93 },
         "2.5": { "any": 0.86 }},
  10: { "0.7": { "0.50": 1.27, "0.60": 1.23, "0.70": 1.19, "0.85": 1.13, "1.00": 1.06 },
         "1.0": { "0.50": 1.11, "0.60": 1.08, "0.70": 1.06, "0.85": 1.01, "1.00": 0.97 },
         "1.5": { "0.50": 0.96, "0.60": 0.95, "0.70": 0.94, "0.85": 0.92, "1.00": 0.89 },
         "2.5": { "any": 0.83 }},
  15: { "0.7": { "0.50": 1.25, "0.60": 1.21, "0.70": 1.17, "0.85": 1.10, "1.00": 1.03 },
         "1.0": { "0.50": 1.08, "0.60": 1.06, "0.70": 1.03, "0.85": 0.99, "1.00": 0.94 },
         "1.5": { "0.50": 0.93, "0.60": 0.92, "0.70": 0.91, "0.85": 0.88, "1.00": 0.86 },
         "2.5": { "any": 0.79 }},
  20: { "0.7": { "0.50": 1.23, "0.60": 1.18, "0.70": 1.14, "0.85": 1.08, "1.00": 1.01 },
         "1.0": { "0.50": 1.06, "0.60": 1.03, "0.70": 1.00, "0.85": 0.96, "1.00": 0.91 },
         "1.5": { "0.50": 0.90, "0.60": 0.89, "0.70": 0.87, "0.85": 0.85, "1.00": 0.83 },
         "2.5": { "any": 0.76 }},
  25: { "1.0": { "0.50": 1.03, "0.60": 1.00, "0.70": 0.97, "0.85": 0.93, "1.00": 0.88 },
         "1.5": { "0.50": 0.87, "0.60": 0.86, "0.70": 0.84, "0.85": 0.83, "1.00": 0.80 },
         "2.5": { "any": 0.72 }},
    
  
  },
  PAPER65: {
    5: { "0.7": { "0.50": 1.31, "0.60": 1.27, "0.70": 1.23, "0.85": 1.16, "1.00": 1.09 },
         "1.0": { "0.50": 1.14, "0.60": 1.11, "0.70": 1.09, "0.85": 1.04, "1.00": 1.00 },
         "1.5": { "0.50": 0.99, "0.60": 0.98, "0.70": 0.96, "0.85": 0.94, "1.00": 0.92 },
         "2.5": { "any": 0.85 }},
    10:{ "0.7": { "0.50": 1.29, "0.60": 1.24, "0.70": 1.20, "0.85": 1.14, "1.00": 1.06 },
         "1.0": { "0.50": 1.11, "0.60": 1.09, "0.70": 1.06, "0.85": 1.02, "1.00": 0.97 },
         "1.5": { "0.50": 0.96, "0.60": 0.95, "0.70": 0.93, "0.85": 0.91, "1.00": 0.89 },
         "2.5": { "any": 0.82 }},
    15:{ "0.7": { "0.50": 1.26, "0.60": 1.22, "0.70": 1.18, "0.85": 1.11, "1.00": 1.04 },
         "1.0": { "0.50": 1.09, "0.60": 1.06, "0.70": 1.03, "0.85": 0.98, "1.00": 0.94 },
         "1.5": { "0.50": 0.93, "0.60": 0.91, "0.70": 0.90, "0.85": 0.88, "1.00": 0.85 },
         "2.5": { "any": 0.78 }},
    20:{ "0.7": { "0.50": 1.24, "0.60": 1.20, "0.70": 1.15, "0.85": 1.08, "1.00": 1.01 },
         "1.0": { "0.50": 1.06, "0.60": 1.03, "0.70": 1.00, "0.85": 0.95, "1.00": 0.90 },
         "1.5": { "0.50": 0.90, "0.60": 0.90, "0.70": 0.88, "0.85": 0.86, "1.00": 0.84 },
         "2.5": { "any": 0.74 }},
    25:{ "1.0": { "0.50": 1.03, "0.60": 1.00, "0.70": 0.97, "0.85": 0.92, "1.00": 0.87 },
         "1.5": { "0.50": 0.86, "0.60": 0.84, "0.70": 0.83, "0.85": 0.80, "1.00": 0.78 },
         "2.5": { "any": 0.70 }},
    
  },
  PAPER60: {
    5: { "0.7": { "0.50": 1.33, "0.60": 1.28, "0.70": 1.24, "0.85": 1.17, "1.00": 1.10 },
         "1.0": { "0.50": 1.15, "0.60": 1.12, "0.70": 1.09, "0.85": 1.05, "1.00": 1.00 },
         "1.5": { "0.50": 0.99, "0.60": 0.98, "0.70": 0.96, "0.85": 0.94, "1.00": 0.92 },
         "2.5": { "any": 0.84 }},
    10:{ "0.7": { "0.50": 1.30, "0.60": 1.26, "0.70": 1.21, "0.85": 1.14, "1.00": 1.07 },
         "1.0": { "0.50": 1.12, "0.60": 1.09, "0.70": 1.06, "0.85": 1.02, "1.00": 0.97 },
         "1.5": { "0.50": 0.96, "0.60": 0.94, "0.70": 0.93, "0.85": 0.90, "1.00": 0.88 },
         "2.5": { "any": 0.80 }},
    15:{ "0.7": { "0.50": 1.28, "0.60": 1.23, "0.70": 1.19, "0.85": 1.12, "1.00": 1.04 },
         "1.0": { "0.50": 1.09, "0.60": 1.06, "0.70": 1.03, "0.85": 0.98, "1.00": 0.93 },
         "1.5": { "0.50": 0.93, "0.60": 0.91, "0.70": 0.89, "0.85": 0.87, "1.00": 0.84 },
         "2.5": { "any": 0.76 }},
    20:{ "0.7": { "0.50": 1.25, "0.60": 1.21, "0.70": 1.16, "0.85": 1.09, "1.00": 1.01 },
         "1.0": { "0.50": 1.06, "0.60": 1.03, "0.70": 1.00, "0.85": 0.95, "1.00": 0.90 },
         "1.5": { "0.50": 0.95, "0.60": 0.89, "0.70": 0.87, "0.85": 0.86, "1.00": 0.83 },
         "2.5": { "any": 0.72 }},
    25:{ "1.0": { "0.50": 1.03, "0.60": 1.00, "0.70": 0.97, "0.85": 0.92, "1.00": 0.86 },
         "1.5": { "0.50": 0.85, "0.60": 0.83, "0.70": 0.82, "0.85": 0.79, "1.00": 0.76 },
         "2.5": { "any": 0.67 }},
 
  }
};



  //-------------------------------------------------------------------------------------------------------------------------------------------------

// Teljes f2 adatok az összes táblázatból 13.a–16.b:
// (Csak XLPE, PE, PVC, PAPER legfontosabb adatokkal, struktúrája teljes és követi a pdf táblázatokat.)

  //f2:

const f2Data = {
  "triangle7": {
    "XLPE": {
      "1": {
        "0.7": {"0.5":1.09,"0.6":1.04,"0.7":0.99,"0.85":0.93,"1.0":0.87},
        "1.0": {"0.5":1.11,"0.6":1.05,"0.7":1.00,"0.85":0.93,"1.0":0.87},
        "1.5": {"0.5":1.13,"0.6":1.07,"0.7":1.01,"0.85":0.94,"1.0":0.87},
        "2.5": {"0.5":1.17,"0.6":1.09,"0.7":1.03,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":0.97,"0.6":0.90,"0.7":0.84,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":0.98,"0.6":0.91,"0.7":0.85,"0.85":0.77,"1.0":0.71},
        "1.5": {"0.5":1.00,"0.6":0.92,"0.7":0.86,"0.85":0.77,"1.0":0.71},
        "2.5": {"0.5":1.02,"0.6":0.94,"0.7":0.87,"0.85":0.78,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.88,"0.6":0.80,"0.7":0.74,"0.85":0.67,"1.0":0.61},
        "1.0": {"0.5":0.89,"0.6":0.82,"0.7":0.75,"0.85":0.67,"1.0":0.61},
        "1.5": {"0.5":0.90,"0.6":0.82,"0.7":0.76,"0.85":0.68,"1.0":0.61},
        "2.5": {"0.5":0.92,"0.6":0.83,"0.7":0.76,"0.85":0.68,"1.0":0.61}
      },
      "4": {
        "0.7": {"0.5":0.83,"0.6":0.75,"0.7":0.69,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.63,"1.0":0.56},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.63,"1.0":0.56},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.71,"0.85":0.63,"1.0":0.56}
      },
      "5": {
        "0.7": {"0.5":0.79,"0.6":0.71,"0.7":0.65,"0.85":0.58,"1.0":0.52},
        "1.0": {"0.5":0.80,"0.6":0.72,"0.7":0.66,"0.85":0.59,"1.0":0.52},
        "1.5": {"0.5":0.80,"0.6":0.73,"0.7":0.66,"0.85":0.59,"1.0":0.52},
        "2.5": {"0.5":0.81,"0.6":0.73,"0.7":0.67,"0.85":0.59,"1.0":0.52}
      },
      "6": {
        "0.7": {"0.5":0.76,"0.6":0.68,"0.7":0.62,"0.85":0.56,"1.0":0.50},
        "1.0": {"0.5":0.77,"0.6":0.69,"0.7":0.63,"0.85":0.56,"1.0":0.50},
        "1.5": {"0.5":0.78,"0.6":0.70,"0.7":0.64,"0.85":0.56,"1.0":0.50},
        "2.5": {"0.5":0.78,"0.6":0.70,"0.7":0.64,"0.85":0.56,"1.0":0.50}
      },
      "8": {
        "0.7": {"0.5":0.72,"0.6":0.64,"0.7":0.58,"0.85":0.52,"1.0":0.46},
        "1.0": {"0.5":0.73,"0.6":0.65,"0.7":0.59,"0.85":0.52,"1.0":0.46},
        "1.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.46},
        "2.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.46}
      },
      "10": {
        "0.7": {"0.5":0.69,"0.6":0.61,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "1.0": {"0.5":0.70,"0.6":0.62,"0.7":0.57,"0.85":0.50,"1.0":0.44},
        "1.5": {"0.5":0.70,"0.6":0.63,"0.7":0.57,"0.85":0.50,"1.0":0.44},
        "2.5": {"0.5":0.70,"0.6":0.63,"0.7":0.57,"0.85":0.50,"1.0":0.44}
      }
    },
    "PE": {
      "1": {
        "0.7": {"0.5":1.01,"0.6":1.02,"0.7":0.99,"0.85":0.93,"1.0":0.87},
        "1.0": {"0.5":1.06,"0.6":1.05,"0.7":1.00,"0.85":0.93,"1.0":0.87},
        "1.5": {"0.5":1.10,"0.6":1.07,"0.7":1.01,"0.85":0.94,"1.0":0.87},
        "2.5": {"0.5":1.17,"0.6":1.09,"0.7":1.03,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":0.95,"0.6":0.90,"0.7":0.84,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":0.98,"0.6":0.91,"0.7":0.85,"0.85":0.77,"1.0":0.71},
        "1.5": {"0.5":1.00,"0.6":0.92,"0.7":0.86,"0.85":0.77,"1.0":0.71},
        "2.5": {"0.5":1.02,"0.6":0.94,"0.7":0.87,"0.85":0.78,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.88,"0.6":0.80,"0.7":0.74,"0.85":0.67,"1.0":0.61},
        "1.0": {"0.5":0.89,"0.6":0.82,"0.7":0.75,"0.85":0.67,"1.0":0.61},
        "1.5": {"0.5":0.90,"0.6":0.82,"0.7":0.76,"0.85":0.68,"1.0":0.61},
        "2.5": {"0.5":0.92,"0.6":0.83,"0.7":0.76,"0.85":0.68,"1.0":0.61}
      },
      "4": {
        "0.7": {"0.5":0.83,"0.6":0.75,"0.7":0.69,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.63,"1.0":0.56},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.63,"1.0":0.56},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.71,"0.85":0.63,"1.0":0.56}
      },
      "5": {
        "0.7": {"0.5":0.79,"0.6":0.71,"0.7":0.65,"0.85":0.58,"1.0":0.52},
        "1.0": {"0.5":0.80,"0.6":0.72,"0.7":0.66,"0.85":0.59,"1.0":0.52},
        "1.5": {"0.5":0.80,"0.6":0.73,"0.7":0.66,"0.85":0.59,"1.0":0.52},
        "2.5": {"0.5":0.82,"0.6":0.73,"0.7":0.67,"0.85":0.59,"1.0":0.52}
      },
      "6": {
        "0.7": {"0.5":0.76,"0.6":0.68,"0.7":0.62,"0.85":0.55,"1.0":0.50},
        "1.0": {"0.5":0.77,"0.6":0.69,"0.7":0.63,"0.85":0.56,"1.0":0.50},
        "1.5": {"0.5":0.78,"0.6":0.70,"0.7":0.64,"0.85":0.56,"1.0":0.50},
        "2.5": {"0.5":0.78,"0.6":0.70,"0.7":0.64,"0.85":0.56,"1.0":0.50}
      },
      "8": {
        "0.7": {"0.5":0.72,"0.6":0.64,"0.7":0.58,"0.85":0.52,"1.0":0.46},
        "1.0": {"0.5":0.73,"0.6":0.65,"0.7":0.59,"0.85":0.52,"1.0":0.46},
        "1.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.46},
        "2.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.46}
      },
      "10": {
        "0.7": {"0.5":0.69,"0.6":0.61,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "1.0": {"0.5":0.70,"0.6":0.62,"0.7":0.57,"0.85":0.50,"1.0":0.44},
        "1.5": {"0.5":0.70,"0.6":0.63,"0.7":0.57,"0.85":0.50,"1.0":0.44},
        "2.5": {"0.5":0.70,"0.6":0.63,"0.7":0.57,"0.85":0.50,"1.0":0.44}
      }
    }
  },

  "triangle7b": {
    "PVC": {
      "1": {
        "0.7": {"0.5":1.01,"0.6":1.02,"0.7":0.99,"0.85":0.93,"1.0":0.87},
        "1.0": {"0.5":1.04,"0.6":1.05,"0.7":1.00,"0.85":0.93,"1.0":0.87},
        "1.5": {"0.5":1.07,"0.6":1.06,"0.7":1.01,"0.85":0.94,"1.0":0.87},
        "2.5": {"0.5":1.11,"0.6":1.08,"0.7":1.01,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":0.94,"0.6":0.89,"0.7":0.84,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":0.97,"0.6":0.91,"0.7":0.85,"0.85":0.77,"1.0":0.71},
        "1.5": {"0.5":0.99,"0.6":0.92,"0.7":0.87,"0.85":0.77,"1.0":0.71},
        "2.5": {"0.5":1.03,"0.6":0.93,"0.7":0.87,"0.85":0.78,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.88,"0.6":0.79,"0.7":0.74,"0.85":0.67,"1.0":0.61},
        "1.0": {"0.5":0.90,"0.6":0.81,"0.7":0.75,"0.85":0.67,"1.0":0.61},
        "1.5": {"0.5":0.92,"0.6":0.83,"0.7":0.76,"0.85":0.68,"1.0":0.61},
        "2.5": {"0.5":0.93,"0.6":0.83,"0.7":0.77,"0.85":0.68,"1.0":0.61}
      },
      "4": {
        "0.7": {"0.5":0.82,"0.6":0.75,"0.7":0.69,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.71,"0.85":0.62,"1.0":0.56},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.71,"0.85":0.63,"1.0":0.56}
      },
      "5": {
        "0.7": {"0.5":0.78,"0.6":0.71,"0.7":0.65,"0.85":0.58,"1.0":0.52},
        "1.0": {"0.5":0.80,"0.6":0.72,"0.7":0.66,"0.85":0.58,"1.0":0.52},
        "1.5": {"0.5":0.80,"0.6":0.73,"0.7":0.66,"0.85":0.58,"1.0":0.52},
        "2.5": {"0.5":0.81,"0.6":0.73,"0.7":0.67,"0.85":0.59,"1.0":0.52}
      },
      "6": {
        "0.7": {"0.5":0.75,"0.6":0.68,"0.7":0.62,"0.85":0.55,"1.0":0.50},
        "1.0": {"0.5":0.76,"0.6":0.69,"0.7":0.63,"0.85":0.56,"1.0":0.50},
        "1.5": {"0.5":0.77,"0.6":0.70,"0.7":0.63,"0.85":0.56,"1.0":0.50},
        "2.5": {"0.5":0.78,"0.6":0.70,"0.7":0.64,"0.85":0.56,"1.0":0.50}
      },
      "8": {
        "0.7": {"0.5":0.71,"0.6":0.64,"0.7":0.58,"0.85":0.51,"1.0":0.46},
        "1.0": {"0.5":0.72,"0.6":0.65,"0.7":0.59,"0.85":0.52,"1.0":0.46},
        "1.5": {"0.5":0.73,"0.6":0.65,"0.7":0.59,"0.85":0.52,"1.0":0.46},
        "2.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.46}
      },
      "10": {
        "0.7": {"0.5":0.68,"0.6":0.61,"0.7":0.55,"0.85":0.49,"1.0":0.44},
        "1.0": {"0.5":0.69,"0.6":0.62,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "1.5": {"0.5":0.70,"0.6":0.62,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "2.5": {"0.5":0.70,"0.6":0.63,"0.7":0.56,"0.85":0.49,"1.0":0.44}
      }
    },
    "Paper": {
      "1": {
        "0.7": {"0.5":0.99,"0.6":0.95,"0.7":0.93,"0.85":0.87,"1.0":0.83},
        "1.0": {"0.5":1.03,"0.6":1.01,"0.7":0.94,"0.85":0.89,"1.0":0.83},
        "1.5": {"0.5":1.06,"0.6":1.04,"0.7":1.01,"0.85":0.94,"1.0":0.87},
        "2.5": {"0.5":1.15,"0.6":1.08,"0.7":1.02,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":0.92,"0.6":0.88,"0.7":0.84,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":0.94,"0.6":0.91,"0.7":0.85,"0.85":0.77,"1.0":0.71},
        "1.5": {"0.5":0.96,"0.6":0.92,"0.7":0.86,"0.85":0.77,"1.0":0.71},
        "2.5": {"0.5":1.01,"0.6":0.93,"0.7":0.87,"0.85":0.78,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.84,"0.6":0.77,"0.7":0.74,"0.85":0.67,"1.0":0.61},
        "1.0": {"0.5":0.86,"0.6":0.81,"0.7":0.75,"0.85":0.67,"1.0":0.61},
        "1.5": {"0.5":0.88,"0.6":0.82,"0.7":0.76,"0.85":0.68,"1.0":0.61},
        "2.5": {"0.5":0.91,"0.6":0.83,"0.7":0.76,"0.85":0.68,"1.0":0.61}
      },
      "4": {
        "0.7": {"0.5":0.82,"0.6":0.74,"0.7":0.69,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.83,"0.6":0.76,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "2.5": {"0.5":0.86,"0.6":0.77,"0.7":0.71,"0.85":0.63,"1.0":0.56}
      },
      "5": {
        "0.7": {"0.5":0.78,"0.6":0.70,"0.7":0.65,"0.85":0.58,"1.0":0.52},
        "1.0": {"0.5":0.79,"0.6":0.72,"0.7":0.66,"0.85":0.58,"1.0":0.52},
        "1.5": {"0.5":0.80,"0.6":0.73,"0.7":0.66,"0.85":0.58,"1.0":0.52},
        "2.5": {"0.5":0.82,"0.6":0.73,"0.7":0.67,"0.85":0.59,"1.0":0.52}
      },
      "6": {
        "0.7": {"0.5":0.75,"0.6":0.67,"0.7":0.62,"0.85":0.55,"1.0":0.50},
        "1.0": {"0.5":0.76,"0.6":0.69,"0.7":0.63,"0.85":0.55,"1.0":0.50},
        "1.5": {"0.5":0.77,"0.6":0.70,"0.7":0.63,"0.85":0.56,"1.0":0.50},
        "2.5": {"0.5":0.78,"0.6":0.70,"0.7":0.64,"0.85":0.56,"1.0":0.50}
      },
      "8": {
        "0.7": {"0.5":0.71,"0.6":0.64,"0.7":0.58,"0.85":0.51,"1.0":0.46},
        "1.0": {"0.5":0.72,"0.6":0.65,"0.7":0.59,"0.85":0.52,"1.0":0.46},
        "1.5": {"0.5":0.73,"0.6":0.65,"0.7":0.59,"0.85":0.52,"1.0":0.46},
        "2.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.46}
      },
      "10": {
        "0.7": {"0.5":0.68,"0.6":0.61,"0.7":0.55,"0.85":0.49,"1.0":0.44},
        "1.0": {"0.5":0.69,"0.6":0.62,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "1.5": {"0.5":0.70,"0.6":0.62,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "2.5": {"0.5":0.70,"0.6":0.62,"0.7":0.56,"0.85":0.49,"1.0":0.44}
      }
    }
  },

  "triangle25": {
    "XLPE": {
      "1": {
        "0.7": {"0.5":1.09,"0.6":1.04,"0.7":0.99,"0.85":0.93,"1.0":0.87},
        "1.0": {"0.5":1.11,"0.6":1.05,"0.7":1.00,"0.85":0.93,"1.0":0.87},
        "1.5": {"0.5":1.13,"0.6":1.07,"0.7":1.01,"0.85":0.94,"1.0":0.87},
        "2.5": {"0.5":1.17,"0.6":1.09,"0.7":1.03,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":1.01,"0.6":0.94,"0.7":0.89,"0.85":0.82,"1.0":0.75},
        "1.0": {"0.5":1.02,"0.6":0.95,"0.7":0.89,"0.85":0.82,"1.0":0.75},
        "1.5": {"0.5":1.06,"0.6":0.99,"0.7":0.92,"0.85":0.82,"1.0":0.75},
        "2.5": {"0.5":1.09,"0.6":1.01,"0.7":0.93,"0.85":0.83,"1.0":0.75}
      },
      "3": {
        "0.7": {"0.5":0.92,"0.6":0.84,"0.7":0.79,"0.85":0.74,"1.0":0.67},
        "1.0": {"0.5":0.95,"0.6":0.88,"0.7":0.82,"0.85":0.74,"1.0":0.67},
        "1.5": {"0.5":0.97,"0.6":0.89,"0.7":0.82,"0.85":0.75,"1.0":0.67},
        "2.5": {"0.5":0.99,"0.6":0.91,"0.7":0.83,"0.85":0.74,"1.0":0.67}
      },
      "4": {
        "0.7": {"0.5":0.91,"0.6":0.84,"0.7":0.78,"0.85":0.70,"1.0":0.64},
        "1.0": {"0.5":0.92,"0.6":0.84,"0.7":0.78,"0.85":0.70,"1.0":0.64},
        "1.5": {"0.5":0.93,"0.6":0.85,"0.7":0.79,"0.85":0.70,"1.0":0.64},
        "2.5": {"0.5":0.95,"0.6":0.86,"0.7":0.79,"0.85":0.71,"1.0":0.64}
      },
      "5": {
        "0.7": {"0.5":0.88,"0.6":0.80,"0.7":0.74,"0.85":0.67,"1.0":0.60},
        "1.0": {"0.5":0.89,"0.6":0.81,"0.7":0.75,"0.85":0.67,"1.0":0.60},
        "1.5": {"0.5":0.90,"0.6":0.82,"0.7":0.75,"0.85":0.67,"1.0":0.60},
        "2.5": {"0.5":0.91,"0.6":0.83,"0.7":0.76,"0.85":0.67,"1.0":0.60}
      },
      "6": {
        "0.7": {"0.5":0.86,"0.6":0.79,"0.7":0.72,"0.85":0.66,"1.0":0.59},
        "1.0": {"0.5":0.87,"0.6":0.79,"0.7":0.73,"0.85":0.66,"1.0":0.59},
        "1.5": {"0.5":0.88,"0.6":0.81,"0.7":0.73,"0.85":0.66,"1.0":0.59},
        "2.5": {"0.5":0.89,"0.6":0.81,"0.7":0.74,"0.85":0.67,"1.0":0.59}
      },
      "8": {
        "0.7": {"0.5":0.83,"0.6":0.76,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.71,"0.85":0.62,"1.0":0.56}
      },
      "10": {
        "0.7": {"0.5":0.81,"0.6":0.74,"0.7":0.68,"0.85":0.60,"1.0":0.54},
        "1.0": {"0.5":0.82,"0.6":0.74,"0.7":0.69,"0.85":0.60,"1.0":0.54},
        "1.5": {"0.5":0.83,"0.6":0.75,"0.7":0.69,"0.85":0.60,"1.0":0.54},
        "2.5": {"0.5":0.84,"0.6":0.76,"0.7":0.69,"0.85":0.61,"1.0":0.54}
      }
    },
    "PE": {
      "1": {
        "0.7": {"0.5":1.01,"0.6":0.94,"0.7":0.90,"0.85":0.93,"1.0":0.87},
        "1.0": {"0.5":1.05,"0.6":0.99,"0.7":0.93,"0.85":0.87,"1.0":0.87},
        "1.5": {"0.5":1.07,"0.6":1.01,"0.7":0.93,"0.85":0.87,"1.0":0.87},
        "2.5": {"0.5":1.15,"0.6":1.09,"0.7":1.02,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":0.97,"0.6":0.90,"0.7":0.84,"0.85":0.75,"1.0":0.71},
        "1.0": {"0.5":1.00,"0.6":0.95,"0.7":0.88,"0.85":0.75,"1.0":0.71},
        "1.5": {"0.5":1.04,"0.6":0.97,"0.7":0.89,"0.85":0.75,"1.0":0.71},
        "2.5": {"0.5":1.07,"0.6":0.99,"0.7":0.90,"0.85":0.83,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.93,"0.6":0.87,"0.7":0.81,"0.85":0.74,"1.0":0.67},
        "1.0": {"0.5":0.96,"0.6":0.90,"0.7":0.83,"0.85":0.74,"1.0":0.67},
        "1.5": {"0.5":0.97,"0.6":0.89,"0.7":0.82,"0.85":0.74,"1.0":0.67},
        "2.5": {"0.5":0.99,"0.6":0.90,"0.7":0.83,"0.85":0.74,"1.0":0.67}
      },
      "4": {
        "0.7": {"0.5":0.91,"0.6":0.84,"0.7":0.78,"0.85":0.70,"1.0":0.64},
        "1.0": {"0.5":0.92,"0.6":0.84,"0.7":0.78,"0.85":0.70,"1.0":0.64},
        "1.5": {"0.5":0.93,"0.6":0.85,"0.7":0.79,"0.85":0.70,"1.0":0.64},
        "2.5": {"0.5":0.95,"0.6":0.86,"0.7":0.79,"0.85":0.71,"1.0":0.64}
      },
  "5": {
  "0.7": {"0.5":0.88,"0.6":0.80,"0.7":0.74,"0.85":0.67,"1.0":0.60},
  "1.0": {"0.5":0.89,"0.6":0.81,"0.7":0.75,"0.85":0.67,"1.0":0.60},
  "1.5": {"0.5":0.90,"0.6":0.82,"0.7":0.75,"0.85":0.67,"1.0":0.60},
  "2.5": {"0.5":0.91,"0.6":0.83,"0.7":0.76,"0.85":0.67,"1.0":0.60}
},

      "6": {
        "0.7": {"0.5":0.86,"0.6":0.79,"0.7":0.72,"0.85":0.66,"1.0":0.59},
        "1.0": {"0.5":0.87,"0.6":0.79,"0.7":0.73,"0.85":0.66,"1.0":0.59},
        "1.5": {"0.5":0.88,"0.6":0.81,"0.7":0.73,"0.85":0.66,"1.0":0.59},
        "2.5": {"0.5":0.89,"0.6":0.81,"0.7":0.74,"0.85":0.67,"1.0":0.59}
      },
      "8": {
        "0.7": {"0.5":0.83,"0.6":0.76,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.71,"0.85":0.62,"1.0":0.56}
      },
      "10": {
        "0.7": {"0.5":0.81,"0.6":0.74,"0.7":0.68,"0.85":0.60,"1.0":0.54},
        "1.0": {"0.5":0.82,"0.6":0.74,"0.7":0.69,"0.85":0.60,"1.0":0.54},
        "1.5": {"0.5":0.83,"0.6":0.75,"0.7":0.69,"0.85":0.60,"1.0":0.54},
        "2.5": {"0.5":0.84,"0.6":0.76,"0.7":0.69,"0.85":0.61,"1.0":0.54}
      }
    }
  },

  "triangle25b": {
    "PVC": {
      "1": {
        "0.7": {"0.5":1.01,"0.6":1.02,"0.7":0.99,"0.85":0.93,"1.0":0.87},
        "1.0": {"0.5":1.04,"0.6":1.05,"0.7":1.00,"0.85":0.93,"1.0":0.87},
        "1.5": {"0.5":1.07,"0.6":1.06,"0.7":1.01,"0.85":0.94,"1.0":0.87},
        "2.5": {"0.5":1.11,"0.6":1.08,"0.7":1.01,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":0.97,"0.6":0.95,"0.7":0.89,"0.85":0.82,"1.0":0.75},
        "1.0": {"0.5":0.96,"0.6":0.90,"0.7":0.82,"0.85":0.75,"1.0":0.75},
        "1.5": {"0.5":1.03,"0.6":0.97,"0.7":0.91,"0.85":0.82,"1.0":0.75},
        "2.5": {"0.5":0.98,"0.6":0.92,"0.7":0.83,"0.85":0.75,"1.0":0.75}
      },
      "3": {
        "0.7": {"0.5":0.94,"0.6":0.88,"0.7":0.82,"0.85":0.74,"1.0":0.67},
        "1.0": {"0.5":0.97,"0.6":0.88,"0.7":0.82,"0.85":0.74,"1.0":0.67},
        "1.5": {"0.5":0.97,"0.6":0.89,"0.7":0.83,"0.85":0.74,"1.0":0.67},
        "2.5": {"0.5":0.98,"0.6":0.90,"0.7":0.84,"0.85":0.74,"1.0":0.67}
      },
      "4": {
        "0.7": {"0.5":0.91,"0.6":0.84,"0.7":0.78,"0.85":0.70,"1.0":0.64},
        "1.0": {"0.5":0.92,"0.6":0.85,"0.7":0.79,"0.85":0.70,"1.0":0.64},
        "1.5": {"0.5":0.93,"0.6":0.86,"0.7":0.79,"0.85":0.70,"1.0":0.64},
        "2.5": {"0.5":0.95,"0.6":0.87,"0.7":0.80,"0.85":0.71,"1.0":0.64}
      },
      "5": {
        "0.7": {"0.5":0.88,"0.6":0.81,"0.7":0.75,"0.85":0.67,"1.0":0.60},
        "1.0": {"0.5":0.89,"0.6":0.82,"0.7":0.76,"0.85":0.67,"1.0":0.60},
        "1.5": {"0.5":0.90,"0.6":0.82,"0.7":0.76,"0.85":0.67,"1.0":0.60},
        "2.5": {"0.5":0.91,"0.6":0.83,"0.7":0.77,"0.85":0.67,"1.0":0.60}
      },
      "6": {
        "0.7": {"0.5":0.86,"0.6":0.79,"0.7":0.73,"0.85":0.65,"1.0":0.59},
        "1.0": {"0.5":0.87,"0.6":0.80,"0.7":0.74,"0.85":0.65,"1.0":0.59},
        "1.5": {"0.5":0.88,"0.6":0.81,"0.7":0.74,"0.85":0.65,"1.0":0.59},
        "2.5": {"0.5":0.89,"0.6":0.81,"0.7":0.75,"0.85":0.65,"1.0":0.59}
      },
      "8": {
        "0.7": {"0.5":0.83,"0.6":0.76,"0.7":0.70,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.85,"0.6":0.77,"0.7":0.71,"0.85":0.62,"1.0":0.56},
        "1.5": {"0.5":0.85,"0.6":0.78,"0.7":0.71,"0.85":0.62,"1.0":0.56},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.72,"0.85":0.62,"1.0":0.56}
      },
      "10": {
        "0.7": {"0.5":0.82,"0.6":0.75,"0.7":0.69,"0.85":0.60,"1.0":0.54},
        "1.0": {"0.5":0.83,"0.6":0.75,"0.7":0.69,"0.85":0.60,"1.0":0.54},
        "1.5": {"0.5":0.83,"0.6":0.76,"0.7":0.70,"0.85":0.61,"1.0":0.54},
        "2.5": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.61,"1.0":0.54}
      }
    },
    "Paper": {
      "1": {
        "0.7": {"0.5":0.94,"0.6":0.95,"0.7":0.97,"0.85":0.93,"1.0":0.87},
        "1.0": {"0.5":0.99,"0.6":1.00,"0.7":0.99,"0.85":0.93,"1.0":0.87},
        "1.5": {"0.5":1.06,"0.6":1.01,"0.7":0.99,"0.85":0.93,"1.0":0.87},
        "2.5": {"0.5":1.15,"0.6":1.09,"0.7":1.02,"0.85":0.94,"1.0":0.87}
      },
      "2": {
        "0.7": {"0.5":0.90,"0.6":0.91,"0.7":0.88,"0.85":0.82,"1.0":0.75},
        "1.0": {"0.5":0.97,"0.6":0.98,"0.7":0.94,"0.85":0.82,"1.0":0.75},
        "1.5": {"0.5":1.02,"0.6":0.99,"0.7":0.94,"0.85":0.82,"1.0":0.75},
        "2.5": {"0.5":1.07,"0.6":0.99,"0.7":0.95,"0.85":0.82,"1.0":0.75}
      },
      "3": {
        "0.7": {"0.5":0.86,"0.6":0.82,"0.7":0.80,"0.85":0.74,"1.0":0.67},
        "1.0": {"0.5":0.91,"0.6":0.87,"0.7":0.81,"0.85":0.74,"1.0":0.67},
        "1.5": {"0.5":0.95,"0.6":0.88,"0.7":0.81,"0.85":0.74,"1.0":0.67},
        "2.5": {"0.5":0.97,"0.6":0.89,"0.7":0.82,"0.85":0.74,"1.0":0.67}
      },
      "4": {
        "0.7": {"0.5":0.86,"0.6":0.82,"0.7":0.76,"0.85":0.70,"1.0":0.64},
        "1.0": {"0.5":0.89,"0.6":0.83,"0.7":0.77,"0.85":0.70,"1.0":0.64},
        "1.5": {"0.5":0.91,"0.6":0.83,"0.7":0.77,"0.85":0.70,"1.0":0.64},
        "2.5": {"0.5":0.92,"0.6":0.84,"0.7":0.78,"0.85":0.71,"1.0":0.64}
      },
      "5": {
        "0.7": {"0.5":0.84,"0.6":0.79,"0.7":0.73,"0.85":0.67,"1.0":0.60},
        "1.0": {"0.5":0.89,"0.6":0.83,"0.7":0.77,"0.85":0.67,"1.0":0.60},
        "1.5": {"0.5":0.87,"0.6":0.80,"0.7":0.73,"0.85":0.67,"1.0":0.60},
        "2.5": {"0.5":0.88,"0.6":0.81,"0.7":0.74,"0.85":0.67,"1.0":0.60}
      },
      "6": {
        "0.7": {"0.5":0.83,"0.6":0.77,"0.7":0.71,"0.85":0.65,"1.0":0.59},
        "1.0": {"0.5":0.84,"0.6":0.80,"0.7":0.74,"0.85":0.65,"1.0":0.59},
        "1.5": {"0.5":0.85,"0.6":0.81,"0.7":0.74,"0.85":0.65,"1.0":0.59},
        "2.5": {"0.5":0.87,"0.6":0.82,"0.7":0.75,"0.85":0.66,"1.0":0.59}
      },
      "8": {
        "0.7": {"0.5":0.80,"0.6":0.77,"0.7":0.67,"0.85":0.62,"1.0":0.56},
        "1.0": {"0.5":0.81,"0.6":0.79,"0.7":0.74,"0.85":0.62,"1.0":0.56},
        "1.5": {"0.5":0.83,"0.6":0.79,"0.7":0.74,"0.85":0.62,"1.0":0.56},
        "2.5": {"0.5":0.85,"0.6":0.80,"0.7":0.75,"0.85":0.63,"1.0":0.56}
      },
      "10": {
        "0.7": {"0.5":0.78,"0.6":0.71,"0.7":0.65,"0.85":0.60,"1.0":0.54},
        "1.0": {"0.5":0.79,"0.6":0.71,"0.7":0.65,"0.85":0.60,"1.0":0.54},
        "1.5": {"0.5":0.82,"0.6":0.73,"0.7":0.66,"0.85":0.61,"1.0":0.54},
        "2.5": {"0.5":0.73,"0.6":0.66,"0.7":0.61,"0.85":0.54,"1.0":0.54}
      }
    }
  },

  "flat7": {
    "XLPE": {
      "1": {
        "0.7": {"0.5":1.08,"0.6":1.05,"0.7":0.99,"0.85":0.91,"1.0":0.85},
        "1.0": {"0.5":1.13,"0.6":1.07,"0.7":1.00,"0.85":0.92,"1.0":0.85},
        "1.5": {"0.5":1.18,"0.6":1.09,"0.7":1.01,"0.85":0.92,"1.0":0.85},
        "2.5": {"0.5":1.19,"0.6":1.11,"0.7":1.03,"0.85":0.93,"1.0":0.85}
      },
      "2": {
        "0.7": {"0.5":1.01,"0.6":0.93,"0.7":0.86,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":1.03,"0.6":0.94,"0.7":0.87,"0.85":0.78,"1.0":0.71},
        "1.5": {"0.5":1.05,"0.6":0.95,"0.7":0.88,"0.85":0.78,"1.0":0.71},
        "2.5": {"0.5":0.96,"0.6":0.88,"0.7":0.79,"0.85":0.71,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.92,"0.6":0.84,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "1.0": {"0.5":0.93,"0.6":0.85,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "1.5": {"0.5":0.95,"0.6":0.86,"0.7":0.78,"0.85":0.69,"1.0":0.62},
        "2.5": {"0.5":0.96,"0.6":0.87,"0.7":0.79,"0.85":0.69,"1.0":0.62}
      },
      "4": {
        "0.7": {"0.5":0.88,"0.6":0.80,"0.7":0.73,"0.85":0.65,"1.0":0.58},
        "1.0": {"0.5":0.89,"0.6":0.80,"0.7":0.73,"0.85":0.65,"1.0":0.58},
        "1.5": {"0.5":0.90,"0.6":0.81,"0.7":0.74,"0.85":0.65,"1.0":0.58},
        "2.5": {"0.5":0.91,"0.6":0.82,"0.7":0.74,"0.85":0.65,"1.0":0.58}
      },
      "5": {
        "0.7": {"0.5":0.84,"0.6":0.76,"0.7":0.69,"0.85":0.61,"1.0":0.55},
        "1.0": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.61,"1.0":0.55},
        "1.5": {"0.5":0.87,"0.6":0.78,"0.7":0.70,"0.85":0.62,"1.0":0.55},
        "2.5": {"0.5":0.87,"0.6":0.78,"0.7":0.71,"0.85":0.62,"1.0":0.55}
      },
      "6": {
        "0.7": {"0.5":0.82,"0.6":0.74,"0.7":0.67,"0.85":0.59,"1.0":0.53},
        "1.0": {"0.5":0.83,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53},
        "1.5": {"0.5":0.84,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53},
        "2.5": {"0.5":0.86,"0.6":0.76,"0.7":0.69,"0.85":0.60,"1.0":0.53}
      },
      "8": {
        "0.7": {"0.5":0.79,"0.6":0.71,"0.7":0.64,"0.85":0.57,"1.0":0.51},
        "1.0": {"0.5":0.83,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53},
        "1.5": {"0.5":0.82,"0.6":0.74,"0.7":0.67,"0.85":0.59,"1.0":0.53},
        "2.5": {"0.5":0.85,"0.6":0.76,"0.7":0.69,"0.85":0.60,"1.0":0.53}
      },
      "10": {
        "0.7": {"0.5":0.77,"0.6":0.69,"0.7":0.62,"0.85":0.55,"1.0":0.49},
        "1.0": {"0.5":0.78,"0.6":0.69,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "1.5": {"0.5":0.79,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "2.5": {"0.5":0.80,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49}
      }
    },
    "PE": {
      "1": {
        "0.7": {"0.5":0.98,"0.6":0.99,"0.7":0.99,"0.85":0.91,"1.0":0.85},
        "1.0": {"0.5":1.03,"0.6":1.00,"0.7":0.92,"0.85":0.85,"1.0":0.85},
        "1.5": {"0.5":1.11,"0.6":1.07,"0.7":1.01,"0.85":0.93,"1.0":0.85},
        "2.5": {"0.5":1.11,"0.6":1.10,"0.7":1.03,"0.85":0.93,"1.0":0.85}
      },
      "2": {
        "0.7": {"0.5":0.93,"0.6":0.92,"0.7":0.86,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":0.98,"0.6":0.94,"0.7":0.87,"0.85":0.78,"1.0":0.71},
        "1.5": {"0.5":1.02,"0.6":0.95,"0.7":0.87,"0.85":0.78,"1.0":0.71},
        "2.5": {"0.5":0.96,"0.6":0.88,"0.7":0.79,"0.85":0.71,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.89,"0.6":0.84,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "1.0": {"0.5":0.93,"0.6":0.85,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "1.5": {"0.5":0.95,"0.6":0.86,"0.7":0.78,"0.85":0.69,"1.0":0.62},
        "2.5": {"0.5":0.96,"0.6":0.86,"0.7":0.79,"0.85":0.69,"1.0":0.62}
      },
      "4": {
        "0.7": {"0.5":0.87,"0.6":0.80,"0.7":0.73,"0.85":0.65,"1.0":0.58},
        "1.0": {"0.5":0.89,"0.6":0.80,"0.7":0.73,"0.85":0.65,"1.0":0.58},
        "1.5": {"0.5":0.90,"0.6":0.81,"0.7":0.74,"0.85":0.65,"1.0":0.58},
        "2.5": {"0.5":0.91,"0.6":0.82,"0.7":0.74,"0.85":0.65,"1.0":0.58}
      },
      "5": {
        "0.7": {"0.5":0.84,"0.6":0.76,"0.7":0.69,"0.85":0.61,"1.0":0.55},
        "1.0": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.61,"1.0":0.55},
        "1.5": {"0.5":0.86,"0.6":0.78,"0.7":0.70,"0.85":0.62,"1.0":0.55},
        "2.5": {"0.5":0.87,"0.6":0.78,"0.7":0.71,"0.85":0.62,"1.0":0.55}
      },
      "6": {
        "0.7": {"0.5":0.82,"0.6":0.74,"0.7":0.67,"0.85":0.59,"1.0":0.53},
        "1.0": {"0.5":0.83,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53},
        "1.5": {"0.5":0.84,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53},
        "2.5": {"0.5":0.85,"0.6":0.76,"0.7":0.69,"0.85":0.60,"1.0":0.53}
      },
      "8": {
        "0.7": {"0.5":0.79,"0.6":0.71,"0.7":0.64,"0.85":0.57,"1.0":0.51},
        "1.0": {"0.5":0.81,"0.6":0.72,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "1.5": {"0.5":0.82,"0.6":0.74,"0.7":0.66,"0.85":0.57,"1.0":0.51},
        "2.5": {"0.5":0.82,"0.6":0.74,"0.7":0.66,"0.85":0.57,"1.0":0.51}
      },
      "10": {
        "0.7": {"0.5":0.77,"0.6":0.69,"0.7":0.62,"0.85":0.55,"1.0":0.49},
        "1.0": {"0.5":0.78,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "1.5": {"0.5":0.79,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "2.5": {"0.5":0.80,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49}
      }
    }
  },

  "flat7b": {
    "PVC": {
      "1": {
        "0.7": {"0.5":0.96,"0.6":0.97,"0.7":0.98,"0.85":0.91,"1.0":0.85},
        "1.0": {"0.5":1.01,"0.6":1.01,"0.7":1.00,"0.85":0.92,"1.0":0.85},
        "1.5": {"0.5":1.07,"0.6":1.05,"0.7":1.01,"0.85":0.92,"1.0":0.85},
        "2.5": {"0.5":1.16,"0.6":1.10,"0.7":1.02,"0.85":0.93,"1.0":0.85}
      },
      "2": {
        "0.7": {"0.5":0.92,"0.6":0.89,"0.7":0.86,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":0.96,"0.6":0.94,"0.7":0.87,"0.85":0.78,"1.0":0.71},
        "1.5": {"0.5":1.00,"0.6":0.95,"0.7":0.88,"0.85":0.78,"1.0":0.71},
        "2.5": {"0.5":1.05,"0.6":0.97,"0.7":0.89,"0.85":0.79,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.88,"0.6":0.84,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "1.0": {"0.5":0.91,"0.6":0.85,"0.7":0.78,"0.85":0.69,"1.0":0.62},
        "1.5": {"0.5":0.95,"0.6":0.86,"0.7":0.79,"0.85":0.62,"1.0":0.59},
        "2.5": {"0.5":0.96,"0.6":0.87,"0.7":0.79,"0.85":0.69,"1.0":0.62}
      },
      "4": {
        "0.7": {"0.5":0.86,"0.6":0.80,"0.7":0.73,"0.85":0.65,"1.0":0.58},
        "1.0": {"0.5":0.89,"0.6":0.81,"0.7":0.74,"0.85":0.65,"1.0":0.58},
        "1.5": {"0.5":0.90,"0.6":0.82,"0.7":0.74,"0.85":0.65,"1.0":0.58},
        "2.5": {"0.5":0.91,"0.6":0.82,"0.7":0.75,"0.85":0.65,"1.0":0.58}
      },
      "5": {
        "0.7": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.61,"1.0":0.55},
        "1.0": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.61,"1.0":0.55},
        "1.5": {"0.5":0.87,"0.6":0.78,"0.7":0.71,"0.85":0.62,"1.0":0.55},
        "2.5": {"0.5":0.87,"0.6":0.79,"0.7":0.71,"0.85":0.62,"1.0":0.55}
      },
      "6": {
        "0.7": {"0.5":0.82,"0.6":0.74,"0.7":0.68,"0.85":0.59,"1.0":0.53},
        "1.0": {"0.5":0.83,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53},
        "1.5": {"0.5":0.84,"0.6":0.76,"0.7":0.69,"0.85":0.60,"1.0":0.53},
        "2.5": {"0.5":0.85,"0.6":0.76,"0.7":0.69,"0.85":0.60,"1.0":0.53}
      },
      "8": {
        "0.7": {"0.5":0.79,"0.6":0.71,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "1.0": {"0.5":0.80,"0.6":0.72,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "1.5": {"0.5":0.81,"0.6":0.72,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "2.5": {"0.5":0.83,"0.6":0.73,"0.7":0.66,"0.85":0.55,"1.0":0.49}
      },
      "10": {
        "0.7": {"0.5":0.77,"0.6":0.69,"0.7":0.62,"0.85":0.55,"1.0":0.49},
        "1.0": {"0.5":0.78,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "1.5": {"0.5":0.79,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "2.5": {"0.5":0.79,"0.6":0.71,"0.7":0.64,"0.85":0.55,"1.0":0.49}
      }
    },
    "Paper": {
      "1": {
        "0.7": {"0.5":0.93,"0.6":0.94,"0.7":0.95,"0.85":0.91,"1.0":0.85},
        "1.0": {"0.5":1.00,"0.6":1.00,"0.7":1.00,"0.85":0.92,"1.0":0.85},
        "1.5": {"0.5":1.09,"0.6":1.06,"0.7":1.01,"0.85":0.92,"1.0":0.85},
        "2.5": {"0.5":1.19,"0.6":1.10,"0.7":1.03,"0.85":0.93,"1.0":0.85}
      },
      "2": {
        "0.7": {"0.5":0.89,"0.6":0.89,"0.7":0.86,"0.85":0.77,"1.0":0.71},
        "1.0": {"0.5":0.95,"0.6":0.93,"0.7":0.87,"0.85":0.78,"1.0":0.71},
        "1.5": {"0.5":1.01,"0.6":0.95,"0.7":0.88,"0.85":0.78,"1.0":0.71},
        "2.5": {"0.5":1.05,"0.6":0.98,"0.7":0.79,"0.85":0.71,"1.0":0.71}
      },
      "3": {
        "0.7": {"0.5":0.86,"0.6":0.82,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "1.0": {"0.5":0.93,"0.6":0.85,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "1.5": {"0.5":0.95,"0.6":0.86,"0.7":0.78,"0.85":0.69,"1.0":0.62},
        "2.5": {"0.5":0.96,"0.6":0.87,"0.7":0.79,"0.85":0.69,"1.0":0.62}
      },
      "4": {
        "0.7": {"0.5":0.84,"0.6":0.78,"0.7":0.73,"0.85":0.65,"1.0":0.58},
        "1.0": {"0.5":0.88,"0.6":0.81,"0.7":0.74,"0.85":0.65,"1.0":0.58},
        "1.5": {"0.5":0.91,"0.6":0.82,"0.7":0.74,"0.85":0.65,"1.0":0.58},
        "2.5": {"0.5":0.91,"0.6":0.82,"0.7":0.75,"0.85":0.65,"1.0":0.58}
      },
      "5": {
        "0.7": {"0.5":0.82,"0.6":0.77,"0.7":0.70,"0.85":0.61,"1.0":0.55},
        "1.0": {"0.5":0.86,"0.6":0.77,"0.7":0.70,"0.85":0.61,"1.0":0.55},
        "1.5": {"0.5":0.87,"0.6":0.78,"0.7":0.70,"0.85":0.61,"1.0":0.55},
        "2.5": {"0.5":0.87,"0.6":0.79,"0.7":0.71,"0.85":0.62,"1.0":0.55}
      },
      "6": {
        "0.7": {"0.5":0.81,"0.6":0.74,"0.7":0.68,"0.85":0.59,"1.0":0.53},
        "1.0": {"0.5":0.83,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53},
        "1.5": {"0.5":0.85,"0.6":0.76,"0.7":0.69,"0.85":0.60,"1.0":0.53},
        "2.5": {"0.5":0.85,"0.6":0.76,"0.7":0.69,"0.85":0.60,"1.0":0.53}
      },
      "8": {
        "0.7": {"0.5":0.78,"0.6":0.71,"0.7":0.64,"0.85":0.57,"1.0":0.51},
        "1.0": {"0.5":0.81,"0.6":0.72,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "1.5": {"0.5":0.81,"0.6":0.72,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "2.5": {"0.5":0.82,"0.6":0.73,"0.7":0.66,"0.85":0.55,"1.0":0.49}
      },
      "10": {
        "0.7": {"0.5":0.77,"0.6":0.69,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "1.0": {"0.5":0.78,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "1.5": {"0.5":0.79,"0.6":0.70,"0.7":0.63,"0.85":0.55,"1.0":0.49},
        "2.5": {"0.5":0.79,"0.6":0.71,"0.7":0.64,"0.85":0.55,"1.0":0.49}
      }
    }
  },

  "3core": {
    "XLPE": {
      "1": {
        "0.7": {"0.5":1.02,"0.6":1.03,"0.7":0.99,"0.85":0.94,"1.0":0.89},
        "1.0": {"0.5":1.06,"0.6":1.05,"0.7":1.00,"0.85":0.94,"1.0":0.89},
        "1.5": {"0.5":1.09,"0.6":1.06,"0.7":1.01,"0.85":0.94,"1.0":0.89},
        "2.5": {"0.5":1.11,"0.6":1.07,"0.7":1.02,"0.85":0.95,"1.0":0.89}
      },
      "2": {
        "0.7": {"0.5":0.95,"0.6":0.89,"0.7":0.84,"0.85":0.77,"1.0":0.72},
        "1.0": {"0.5":0.98,"0.6":0.91,"0.7":0.85,"0.85":0.78,"1.0":0.72},
        "1.5": {"0.5":0.99,"0.6":0.92,"0.7":0.86,"0.85":0.78,"1.0":0.72},
        "2.5": {"0.5":1.01,"0.6":0.94,"0.7":0.87,"0.85":0.79,"1.0":0.72}
      },
      "3": {
        "0.7": {"0.5":0.86,"0.6":0.80,"0.7":0.74,"0.85":0.68,"1.0":0.62},
        "1.0": {"0.5":0.89,"0.6":0.81,"0.7":0.75,"0.85":0.68,"1.0":0.62},
        "1.5": {"0.5":0.90,"0.6":0.83,"0.7":0.76,"0.85":0.68,"1.0":0.62},
        "2.5": {"0.5":0.92,"0.6":0.84,"0.7":0.77,"0.85":0.69,"1.0":0.62}
      },
      "4": {
        "0.7": {"0.5":0.82,"0.6":0.75,"0.7":0.69,"0.85":0.63,"1.0":0.57},
        "1.0": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.63,"1.0":0.57},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.63,"1.0":0.57},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.72,"0.85":0.64,"1.0":0.57}
      },
      "5": {
        "0.7": {"0.5":0.78,"0.6":0.71,"0.7":0.65,"0.85":0.59,"1.0":0.53},
        "1.0": {"0.5":0.80,"0.6":0.72,"0.7":0.66,"0.85":0.59,"1.0":0.53},
        "1.5": {"0.5":0.81,"0.6":0.73,"0.7":0.67,"0.85":0.60,"1.0":0.53},
        "2.5": {"0.5":0.82,"0.6":0.74,"0.7":0.67,"0.85":0.60,"1.0":0.53}
      },
      "6": {
        "0.7": {"0.5":0.75,"0.6":0.68,"0.7":0.63,"0.85":0.56,"1.0":0.51},
        "1.0": {"0.5":0.77,"0.6":0.69,"0.7":0.65,"0.85":0.56,"1.0":0.51},
        "1.5": {"0.5":0.78,"0.6":0.70,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "2.5": {"0.5":0.79,"0.6":0.71,"0.7":0.66,"0.85":0.57,"1.0":0.51}
      },
      "8": {
        "0.7": {"0.5":0.71,"0.6":0.64,"0.7":0.59,"0.85":0.52,"1.0":0.47},
        "1.0": {"0.5":0.72,"0.6":0.65,"0.7":0.60,"0.85":0.52,"1.0":0.47},
        "1.5": {"0.5":0.73,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.47},
        "2.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.53,"1.0":0.47}
      },
      "10": {
        "0.7": {"0.5":0.68,"0.6":0.61,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "1.0": {"0.5":0.69,"0.6":0.62,"0.7":0.56,"0.85":0.50,"1.0":0.44},
        "1.5": {"0.5":0.70,"0.6":0.62,"0.7":0.57,"0.85":0.50,"1.0":0.44},
        "2.5": {"0.5":0.71,"0.6":0.63,"0.7":0.57,"0.85":0.50,"1.0":0.44}
      }
    },
    "PE": {
      "1": {
        "0.7": {"0.5":0.99,"0.6":0.99,"0.7":0.99,"0.85":0.94,"1.0":0.89},
        "1.0": {"0.5":1.03,"0.6":1.00,"0.7":0.99,"0.85":0.94,"1.0":0.89},
        "1.5": {"0.5":1.08,"0.6":1.06,"0.7":1.01,"0.85":0.94,"1.0":0.89},
        "2.5": {"0.5":1.14,"0.6":1.10,"0.7":1.02,"0.85":0.95,"1.0":0.89}
      },
      "2": {
        "0.7": {"0.5":0.91,"0.6":0.89,"0.7":0.84,"0.85":0.77,"1.0":0.72},
        "1.0": {"0.5":0.96,"0.6":0.92,"0.7":0.85,"0.85":0.78,"1.0":0.72},
        "1.5": {"0.5":0.99,"0.6":0.92,"0.7":0.86,"0.85":0.78,"1.0":0.72},
        "2.5": {"0.5":1.01,"0.6":0.94,"0.7":0.87,"0.85":0.79,"1.0":0.72}
      },
      "3": {
        "0.7": {"0.5":0.85,"0.6":0.80,"0.7":0.74,"0.85":0.68,"1.0":0.62},
        "1.0": {"0.5":0.89,"0.6":0.81,"0.7":0.75,"0.85":0.68,"1.0":0.62},
        "1.5": {"0.5":0.92,"0.6":0.83,"0.7":0.76,"0.85":0.68,"1.0":0.62},
        "2.5": {"0.5":0.92,"0.6":0.84,"0.7":0.77,"0.85":0.69,"1.0":0.62}
      },
      "4": {
        "0.7": {"0.5":0.82,"0.6":0.75,"0.7":0.69,"0.85":0.63,"1.0":0.57},
        "1.0": {"0.5":0.84,"0.6":0.76,"0.7":0.70,"0.85":0.63,"1.0":0.57},
        "1.5": {"0.5":0.85,"0.6":0.77,"0.7":0.70,"0.85":0.63,"1.0":0.57},
        "2.5": {"0.5":0.86,"0.6":0.78,"0.7":0.72,"0.85":0.64,"1.0":0.57}
      },
      "5": {
        "0.7": {"0.5":0.78,"0.6":0.71,"0.7":0.65,"0.85":0.59,"1.0":0.53},
        "1.0": {"0.5":0.80,"0.6":0.72,"0.7":0.66,"0.85":0.59,"1.0":0.53},
        "1.5": {"0.5":0.81,"0.6":0.73,"0.7":0.67,"0.85":0.59,"1.0":0.53},
        "2.5": {"0.5":0.82,"0.6":0.74,"0.7":0.67,"0.85":0.60,"1.0":0.53}
      },
      "6": {
        "0.7": {"0.5":0.75,"0.6":0.68,"0.7":0.63,"0.85":0.56,"1.0":0.51},
        "1.0": {"0.5":0.77,"0.6":0.69,"0.7":0.65,"0.85":0.56,"1.0":0.51},
        "1.5": {"0.5":0.78,"0.6":0.70,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "2.5": {"0.5":0.79,"0.6":0.71,"0.7":0.66,"0.85":0.57,"1.0":0.51}
      },
      "8": {
        "0.7": {"0.5":0.71,"0.6":0.64,"0.7":0.59,"0.85":0.52,"1.0":0.47},
        "1.0": {"0.5":0.72,"0.6":0.65,"0.7":0.60,"0.85":0.52,"1.0":0.47},
        "1.5": {"0.5":0.73,"0.6":0.66,"0.7":0.60,"0.85":0.52,"1.0":0.47},
        "2.5": {"0.5":0.74,"0.6":0.66,"0.7":0.60,"0.85":0.53,"1.0":0.47}
      },
      "10": {
        "0.7": {"0.5":0.68,"0.6":0.61,"0.7":0.56,"0.85":0.49,"1.0":0.44},
        "1.0": {"0.5":0.69,"0.6":0.62,"0.7":0.56,"0.85":0.50,"1.0":0.44},
        "1.5": {"0.5":0.70,"0.6":0.62,"0.7":0.57,"0.85":0.50,"1.0":0.44},
        "2.5": {"0.5":0.71,"0.6":0.63,"0.7":0.57,"0.85":0.50,"1.0":0.44}
      }
    }
  },

  "3coreb": {
    "PVC": {
      "1": {
        "0.7": {"0.5":0.91,"0.6":0.92,"0.7":0.94,"0.85":0.94,"1.0":0.89},
        "1.0": {"0.5":0.97,"0.6":0.97,"0.7":1.00,"0.85":0.92,"1.0":0.89},
        "1.5": {"0.5":1.04,"0.6":1.03,"0.7":1.01,"0.85":0.94,"1.0":0.89},
        "2.5": {"0.5":1.13,"0.6":1.07,"0.7":1.02,"0.85":0.95,"1.0":0.89}
      },
      "2": {
        "0.7": {"0.5":0.86,"0.6":0.87,"0.7":0.85,"0.85":0.77,"1.0":0.72},
        "1.0": {"0.5":0.91,"0.6":0.90,"0.7":0.86,"0.85":0.78,"1.0":0.72},
        "1.5": {"0.5":0.97,"0.6":0.93,"0.7":0.87,"0.85":0.78,"1.0":0.72},
        "2.5": {"0.5":1.01,"0.6":0.94,"0.7":0.88,"0.85":0.79,"1.0":0.72}
      },
      "3": {
        "0.7": {"0.5":0.82,"0.6":0.80,"0.7":0.75,"0.85":0.68,"1.0":0.62},
        "1.0": {"0.5":0.86,"0.6":0.82,"0.7":0.76,"0.85":0.69,"1.0":0.62},
        "1.5": {"0.5":0.91,"0.6":0.84,"0.7":0.77,"0.85":0.69,"1.0":0.62},
        "2.5": {"0.5":0.92,"0.6":0.84,"0.7":0.78,"0.85":0.69,"1.0":0.62}
      },
      "4": {
        "0.7": {"0.5":0.80,"0.6":0.76,"0.7":0.70,"0.85":0.63,"1.0":0.57},
        "1.0": {"0.5":0.84,"0.6":0.77,"0.7":0.71,"0.85":0.63,"1.0":0.57},
        "1.5": {"0.5":0.86,"0.6":0.78,"0.7":0.72,"0.85":0.63,"1.0":0.57},
        "2.5": {"0.5":0.87,"0.6":0.79,"0.7":0.73,"0.85":0.64,"1.0":0.57}
      },
      "5": {
        "0.7": {"0.5":0.78,"0.6":0.72,"0.7":0.66,"0.85":0.59,"1.0":0.53},
        "1.0": {"0.5":0.81,"0.6":0.73,"0.7":0.67,"0.85":0.59,"1.0":0.53},
        "1.5": {"0.5":0.83,"0.6":0.74,"0.7":0.67,"0.85":0.59,"1.0":0.53},
        "2.5": {"0.5":0.85,"0.6":0.75,"0.7":0.68,"0.85":0.60,"1.0":0.53}
      },
      "6": {
        "0.7": {"0.5":0.76,"0.6":0.69,"0.7":0.64,"0.85":0.56,"1.0":0.51},
        "1.0": {"0.5":0.80,"0.6":0.70,"0.7":0.65,"0.85":0.57,"1.0":0.51},
        "1.5": {"0.5":0.81,"0.6":0.71,"0.7":0.66,"0.85":0.57,"1.0":0.51},
        "2.5": {"0.5":0.82,"0.6":0.72,"0.7":0.66,"0.85":0.57,"1.0":0.51}
      },
      "8": {
        "0.7": {"0.5":0.72,"0.6":0.69,"0.7":0.59,"0.85":0.52,"1.0":0.47},
        "1.0": {"0.5":0.77,"0.6":0.70,"0.7":0.64,"0.85":0.52,"1.0":0.47},
        "1.5": {"0.5":0.77,"0.6":0.70,"0.7":0.64,"0.85":0.52,"1.0":0.47},
        "2.5": {"0.5":0.77,"0.6":0.70,"0.7":0.64,"0.85":0.52,"1.0":0.47}
      },
      "10": {
        "0.7": {"0.5":0.69,"0.6":0.62,"0.7":0.57,"0.85":0.50,"1.0":0.44},
        "1.0": {"0.5":0.74,"0.6":0.67,"0.7":0.61,"0.85":0.54,"1.0":0.47},
        "1.5": {"0.5":0.74,"0.6":0.67,"0.7":0.61,"0.85":0.54,"1.0":0.47},
        "2.5": {"0.5":0.74,"0.6":0.67,"0.7":0.61,"0.85":0.54,"1.0":0.47}
      }
    },
    "Paper": {
      "1": {
        "0.7": {"0.5":0.90,"0.6":0.91,"0.7":0.93,"0.85":0.96,"1.0":0.91},
        "1.0": {"0.5":0.98,"0.6":0.99,"0.7":1.00,"0.85":0.99,"1.0":0.91},
        "1.5": {"0.5":1.05,"0.6":1.04,"0.7":1.03,"0.85":0.99,"1.0":0.91},
        "2.5": {"0.5":1.14,"0.6":1.09,"0.7":1.04,"0.85":0.99,"1.0":0.91}
      },
      "2": {
        "0.7": {"0.5":0.85,"0.6":0.85,"0.7":0.85,"0.85":0.81,"1.0":0.76},
        "1.0": {"0.5":0.93,"0.6":0.92,"0.7":0.92,"0.85":0.89,"1.0":0.82},
        "1.5": {"0.5":0.98,"0.6":0.95,"0.7":0.95,"0.85":0.90,"1.0":0.82},
        "2.5": {"0.5":1.03,"0.6":0.96,"0.7":0.96,"0.85":0.90,"1.0":0.82}
      },
      "3": {
        "0.7": {"0.5":0.80,"0.6":0.80,"0.7":0.78,"0.85":0.72,"1.0":0.66},
        "1.0": {"0.5":0.87,"0.6":0.86,"0.7":0.83,"0.85":0.80,"1.0":0.73},
        "1.5": {"0.5":0.93,"0.6":0.88,"0.7":0.85,"0.85":0.80,"1.0":0.73},
        "2.5": {"0.5":0.95,"0.6":0.87,"0.7":0.86,"0.85":0.80,"1.0":0.73}
      },
      "4": {
        "0.7": {"0.5":0.76,"0.6":0.74,"0.7":0.74,"0.85":0.68,"1.0":0.61},
        "1.0": {"0.5":0.83,"0.6":0.81,"0.7":0.81,"0.85":0.75,"1.0":0.68},
        "1.5": {"0.5":0.89,"0.6":0.85,"0.7":0.85,"0.85":0.75,"1.0":0.68},
        "2.5": {"0.5":0.92,"0.6":0.87,"0.7":0.86,"0.85":0.75,"1.0":0.68}
      },
      "5": {
        "0.7": {"0.5":0.73,"0.6":0.71,"0.7":0.70,"0.85":0.63,"1.0":0.57},
        "1.0": {"0.5":0.80,"0.6":0.77,"0.7":0.76,"0.85":0.70,"1.0":0.63},
        "1.5": {"0.5":0.87,"0.6":0.81,"0.7":0.81,"0.85":0.70,"1.0":0.63},
        "2.5": {"0.5":0.89,"0.6":0.82,"0.7":0.82,"0.85":0.70,"1.0":0.63}
      },
      "6": {
        "0.7": {"0.5":0.73,"0.6":0.70,"0.7":0.68,"0.85":0.61,"1.0":0.55},
        "1.0": {"0.5":0.81,"0.6":0.77,"0.7":0.74,"0.85":0.69,"1.0":0.63},
        "1.5": {"0.5":0.87,"0.6":0.81,"0.7":0.78,"0.85":0.69,"1.0":0.63},
        "2.5": {"0.5":0.89,"0.6":0.82,"0.7":0.79,"0.85":0.69,"1.0":0.63}
      },
      "8": {
        "0.7": {"0.5":0.70,"0.6":0.66,"0.7":0.63,"0.85":0.56,"1.0":0.51},
        "1.0": {"0.5":0.77,"0.6":0.73,"0.7":0.70,"0.85":0.64,"1.0":0.57},
        "1.5": {"0.5":0.83,"0.6":0.77,"0.7":0.74,"0.85":0.64,"1.0":0.57},
        "2.5": {"0.5":0.86,"0.6":0.79,"0.7":0.76,"0.85":0.64,"1.0":0.57}
      },
      "10": {
        "0.7": {"0.5":0.68,"0.6":0.66,"0.7":0.60,"0.85":0.53,"1.0":0.48},
        "1.0": {"0.5":0.74,"0.6":0.67,"0.7":0.61,"0.85":0.56,"1.0":0.50},
        "1.5": {"0.5":0.84,"0.6":0.74,"0.7":0.67,"0.85":0.61,"1.0":0.54},
        "2.5": {"0.5":0.85,"0.6":0.74,"0.7":0.67,"0.85":0.61,"1.0":0.54}
      }
    }
  }
}



  //------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


// ========== Segédfüggvények ==========

// a legközelebbi nagyobb/egyenlő kulcs (eredeti string kulccsal, pl. "1.0")
function findClosestKey(keys, value) {
  const rows = keys
    .map(k => ({ orig: k, val: (k === 'any' ? Infinity : parseFloat(k)) }))
    .sort((a, b) => a.val - b.val);

  const numVal = (typeof value === 'number') ? value : parseFloat(value);
  if (!rows.length || Number.isNaN(numVal)) return null;

  for (const row of rows) {
    if (numVal <= row.val) return row.orig;
  }
  return rows[rows.length - 1].orig;
}

// a legnagyobb, de <= value kulcs (eredeti string kulccsal), 'any' figyelmen kívül
function findFloorKey(keys, value) {
  const rows = keys
    .filter(k => k !== 'any')
    .map(k => ({ orig: k, val: parseFloat(k) }))
    .filter(r => !Number.isNaN(r.val))
    .sort((a,b) => a.val - b.val);

  const numVal = (typeof value === 'number') ? value : parseFloat(value);
  if (!rows.length || Number.isNaN(numVal)) return null;

  let candidate = null;
  for (const row of rows) {
    if (row.val <= numVal) candidate = row.orig; else break;
  }
  return candidate;
}

function getNested(obj, keys) {
  return keys.reduce((o,k) => (o && k in o) ? o[k] : null, obj);
}

// LF kulcs normalizálók
function lfKeyF1(n) {
  if (n === 1) return "1.00";
  if (n === 0.85) return "0.85";
  return n.toFixed(2); // "0.50", "0.60", "0.70"
}
function lfKeyF2(n) {
  if (n === 1) return "1.0";
  if (n === 0.85) return "0.85";
  return n.toString(); // "0.5","0.6","0.7"
}

// ========== f1 lekérés (szigorú, de ésszerű fallback) ==========
function getF1Value(type, soilT, rho, lf) {
  const temps = f1Data[type];
  if (!temps) return null;

  const tKey = findClosestKey(Object.keys(temps), Number(soilT));
  if (!tKey) return null;

  const rhoData = temps[tKey];

  // RHO: floor (25 °C-nál ha 0.7 nincs, ne ugorjunk fel 1.0-ról le/fel tévesen)
  const rKey = findFloorKey(Object.keys(rhoData), rho);
  if (!rKey) return null;

  const lfData = rhoData[rKey];

  // ha van "any", azt bármely LF-re visszaadjuk
  if ('any' in lfData) return lfData['any'];

  // pontos LF
  if (lf in lfData) return lfData[lf];

  // fallback: legnagyobb <= LF (f1-ben "0.50" formátum kell)
  const lfs = Object.keys(lfData).map(parseFloat).sort((a,b)=>a-b);
  const lfNum = parseFloat(lf);
  for (let i = lfs.length - 1; i >= 0; i--) {
    if (lfNum >= lfs[i]) {
      const key = lfKeyF1(lfs[i]);
      return lfData[key];
    }
  }
  return null;
}

// ========== f2 lekérés ==========
function getF2Value(arr, type, systems, rho, lf) {
  const table = f2Data[arr];
  if (!table) return null;

  const typeData = table[type];
  if (!typeData) return null;

  const sysKey = findFloorKey(Object.keys(typeData), systems);
  if (!sysKey) return null;

  const rhoData = typeData[sysKey];

  const rKey = findFloorKey(Object.keys(rhoData), rho);
  if (!rKey) return null;

  const lfData = rhoData[rKey];

  // pontos LF string
  if (lf in lfData) return lfData[lf];

  // normalizált LF kulcs ("0.50" -> "0.5")
  const lfNorm = lfKeyF2(parseFloat(lf));
  if (lfNorm in lfData) return lfData[lfNorm];

  // fallback: legnagyobb <= LF
  const lfs = Object.keys(lfData).map(parseFloat).sort((a,b)=>a-b);
  const lfNum = parseFloat(lf);
  for (let i = lfs.length - 1; i >= 0; i--) {
    if (lfNum >= lfs[i]) {
      const key = lfKeyF2(lfs[i]);
      return lfData[key];
    }
  }
  return null;
}

// ========== (opcionális) duplikált f2-k összeolvasztása ==========
["triangle7","triangle25","flat7","3core"].forEach(k => {
  const extra = f2Data[k + "b"];
  if (extra) {
    f2Data[k] = { ...(f2Data[k] || {}), ...extra };
    delete f2Data[k + "b"];
  }
});

// ========== Háromfázisú rendszeráram ==========
function computeSystemCurrent(U_volt, PkW) {
  if (!U_volt || !PkW || U_volt <= 0 || PkW < 0) return null;
  return (PkW * 1000) / (Math.sqrt(3) * U_volt);
}

// ========== DOM hivatkozások ==========
const $ = (id) => document.getElementById(id);

const elBase   = $('base');
const elF1t    = $('f1type');
const elSoilT  = $('soilT');
const elRho    = $('rho');
const elLf     = $('lf');

const elArr    = $('arr');
const elF2t    = $('f2type');
const elSys    = $('systems');
const elRho2   = $('rho2');
const elLf2    = $('lf2');
const elDuct   = $('duct');

const outF1    = $('f1v');
const outF2    = $('f2v');
const outTotal = $('total');

const elSysU   = $('sysU');
const elSysP   = $('sysP');
const outSysI  = $('sysI');
const outCheck = $('sysCheck');

const btnCalc  = $('calc');
const btnXlsx  = $('exportXlsx');

let lastResult = null;

// ========== Számítás + UI ==========
function performCalculationAndUpdateUI() {
  const base = Number(elBase.value);
  if (!base || base <= 0) {
    outF1.textContent = '–';
    outF2.textContent = '–';
    outTotal.textContent = 'Nem számolható az adott adatokkal';
    const Ionly = computeSystemCurrent(elSysU?.value, elSysP?.value);
    if (outSysI) outSysI.textContent = Ionly ? Ionly.toFixed(1) + ' A' : '–';
    if (outCheck) { outCheck.textContent = '–'; outCheck.className = 'mono'; }
    lastResult = null;
    return null;
  }

  const f1 = getF1Value(elF1t.value, elSoilT.value, elRho.value, elLf.value);
  const f2 = getF2Value(elArr.value, elF2t.value, elSys.value, elRho2.value, elLf2.value);

  outF1.textContent = (f1 == null) ? 'Nincs adat' : f1.toFixed(3);
  outF2.textContent = (f2 == null) ? 'Nincs adat' : f2.toFixed(3);

  if (f1 == null || f2 == null) {
    outTotal.textContent = 'Nem számolható az adott adatokkal';
    const Ionly = computeSystemCurrent(elSysU.value, elSysP.value);
    if (outSysI) outSysI.textContent = Ionly ? Ionly.toFixed(1) + ' A' : '–';
    if (outCheck) { outCheck.textContent = '–'; outCheck.className = 'mono'; }
    lastResult = { base, f1, f2, total: null, duct: elDuct?.value === 'yes',
                   sysU: elSysU.value, sysP: elSysP.value, I: Ionly, ok: null };
    return lastResult;
  }

  const ductFactor = (elDuct && elDuct.value === 'yes') ? 0.85 : 1.0;
  const total = base * f1 * f2 * ductFactor;
  outTotal.textContent = total.toFixed(1) + ' A';

  const I = computeSystemCurrent(elSysU.value, elSysP.value);
  if (outSysI) outSysI.textContent = I ? I.toFixed(1) + ' A' : '–';

  if (I && total) {
    if (total >= I) {
      outCheck.textContent = 'Kábel megfelelő';
      outCheck.className = 'mono ok';
    } else {
      outCheck.textContent = 'Kábel nem megfelelő';
      outCheck.className = 'mono bad';
    }
  } else {
    outCheck.textContent = '–';
    outCheck.className = 'mono';
  }

  lastResult = { base, f1, f2, total,
                 duct: elDuct?.value === 'yes',
                 sysU: elSysU.value, sysP: elSysP.value, I,
                 ok: (I && total) ? (total >= I) : null };
  return lastResult;
}

// ========== Események ==========
btnCalc?.addEventListener('click', performCalculationAndUpdateUI);
[elSysU, elSysP].forEach(el => el?.addEventListener('input', () => { if (lastResult) performCalculationAndUpdateUI(); }));

// ========== XLSX export ==========
btnXlsx?.addEventListener('click', () => {
  const res = performCalculationAndUpdateUI();
  if (!res) { alert('Először töltsd ki az adatokat és nyomd meg a Számítás gombot.'); return; }
  if (res.f1 == null || res.f2 == null) { alert('Ezekkel az adatokkal nem számolható.'); return; }

  const f1typeEl = elF1t, arrEl = elArr, f2typeEl = elF2t;
  const rows = [
    ['Projekt címe',''],
    ['Kábel fajtája',''],
    ['',''],
    ['Bemenetek','Érték'],
    ['Alapterhelhetőség (A)', res.base ?? '—'],
    ['f1 – Kábel típusa', f1typeEl.selectedOptions[0].text + ` [${f1typeEl.value}]`],
    ['f1 – Talaj hőmérséklete (°C)', elSoilT.value],
    ['f1 – Talaj fajlagos hőellenállása ρ', elRho.value],
    ['f1 – Terhelési tényező', elLf.value],
    ['f2 – Elrendezés', arrEl.selectedOptions[0].text + ` [${arrEl.value}]`],
    ['f2 – Kábel típusa', f2typeEl.selectedOptions[0].text + ` [${f2typeEl.value}]`],
    ['f2 – Kábelrendszerek száma', elSys.value],
    ['f2 – Talaj fajlagos hőellenállása ρ', elRho2.value],
    ['f2 – Terhelési tényező', elLf2.value],
    ['Védőcső', res.duct ? 'Igen (0,85×)' : 'Nem'],
    ['',''],
    ['Eredmények','Érték'],
    ['f1', res.f1.toFixed(3)],
    ['f2', res.f2.toFixed(3)],
    ['Végső terhelhetőség (A)', res.total == null ? 'Nem számolható' : res.total.toFixed(1)],
    ['',''],
    ['Rendszer adatai (opcionális)','Érték'],
    ['Névleges feszültség (V)', elSysU.value || '—'],
    ['Teljesítmény (kW)', elSysP.value || '—'],
    ['Számított rendszeráram (A)', res.I ? res.I.toFixed(1) : '—'],
    ['Összehasonlítás', res.ok == null ? '—' : (res.ok ? 'Kábel megfelelő' : 'Kábel nem megfelelő')],
    ['',''],
    ['Szabvány','MSZ 13207:2020'],
    ['Export dátum/idő', new Date().toLocaleString()],
  ];

  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(rows);
  ws['!cols'] = [{ wch: 38 }, { wch: 28 }];
  XLSX.utils.book_append_sheet(wb, ws, 'Számítás');
  XLSX.writeFile(wb, `kabel_terheles_${Date.now()}.xlsx`);
});
</script>

</body>
</html>
